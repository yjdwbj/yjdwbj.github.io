<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="设置相关 Variables Qt for macOS - Deployment Undocumented_QMake Global Qt Declarations How to use Windows environment variables in Qt5    Lambda 匿名函数 有时候槽函数代码辑逻辑非常简单,可以直接用下面的Lambda匿名函数处理信号,简捷明了.需c++11支持,">
<meta property="og:type" content="article">
<meta property="og:title" content="Qt的一些开发技巧">
<meta property="og:url" content="http://yoursite.com/2017/01/08/Qt的一些开发技巧/index.html">
<meta property="og:site_name" content="Sunrise 博客">
<meta property="og:description" content="设置相关 Variables Qt for macOS - Deployment Undocumented_QMake Global Qt Declarations How to use Windows environment variables in Qt5    Lambda 匿名函数 有时候槽函数代码辑逻辑非常简单,可以直接用下面的Lambda匿名函数处理信号,简捷明了.需c++11支持,">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/imgs/mm_reward_qrcode_1525013906055.png">
<meta property="og:updated_time" content="2021-12-15T12:31:21.165Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Qt的一些开发技巧">
<meta name="twitter:description" content="设置相关 Variables Qt for macOS - Deployment Undocumented_QMake Global Qt Declarations How to use Windows environment variables in Qt5    Lambda 匿名函数 有时候槽函数代码辑逻辑非常简单,可以直接用下面的Lambda匿名函数处理信号,简捷明了.需c++11支持,">
<meta name="twitter:image" content="http://yoursite.com/imgs/mm_reward_qrcode_1525013906055.png">

<link rel="canonical" href="http://yoursite.com/2017/01/08/Qt的一些开发技巧/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Qt的一些开发技巧 | Sunrise 博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Sunrise 博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/08/Qt的一些开发技巧/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="yjdwbj">
      <meta itemprop="description" content="最是人间留不住,朱颜辞镜花辞树">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sunrise 博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Qt的一些开发技巧
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-01-08 08:14:44" itemprop="dateCreated datePublished" datetime="2017-01-08T08:14:44+08:00">2017-01-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-12-15 20:31:21" itemprop="dateModified" datetime="2021-12-15T20:31:21+08:00">2021-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt/" itemprop="url" rel="index"><span itemprop="name">Qt</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <ul>
<li>设置相关<ul>
<li><a href="https://doc.qt.io/qt-5/qmake-variable-reference.html" target="_blank" rel="noopener">Variables</a></li>
<li><a href="https://doc.qt.io/qt-5/macos-deployment.html#macos-version-dependencies" target="_blank" rel="noopener">Qt for macOS - Deployment</a></li>
<li><a href="https://wiki.qt.io/Undocumented_QMake" target="_blank" rel="noopener">Undocumented_QMake</a></li>
<li><a href="https://doc.qt.io/qt-5/qtglobal.html#qEnvironmentVariable" target="_blank" rel="noopener">Global Qt Declarations</a></li>
<li><a href="https://stackoverflow.com/questions/54264854/how-to-use-windows-environment-variables-in-qt5" target="_blank" rel="noopener">How to use Windows environment variables in Qt5</a></li>
</ul>
</li>
</ul>
<h1 id="Lambda-匿名函数"><a href="#Lambda-匿名函数" class="headerlink" title="Lambda 匿名函数"></a>Lambda 匿名函数</h1><ul>
<li><p>有时候槽函数代码辑逻辑非常简单,可以直接用下面的<code>Lambda匿名函数</code>处理信号,简捷明了.需<code>c++11</code>支持,不支持自身递归调用.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QComboBox *cb = new QComboBox(this);</span><br><span class="line">QObject::connect(cb,&amp;QComboBox::currentTextChanged,[=](QString txt)&#123;</span><br><span class="line">                       [...]</span><br><span class="line">                       baseform-&gt;changeJsonValue(btn,uname,</span><br><span class="line">                                               baseform-&gt;mWindow-&gt;mItemMap.key(txt));</span><br><span class="line">                       [...]</span><br><span class="line">                    &#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>函数内部的匿名函数</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">void ActionList::onCustomContextMenu(const QPoint &amp;pos)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  [...]</span><br><span class="line">  auto sawp_lambda_func = [this](int src,int dst) &#123;</span><br><span class="line"></span><br><span class="line">                QVariantList oldvals;</span><br><span class="line">                <span class="keyword">for</span>(int i  = 0 ; i &lt; mTable-&gt;columnCount();i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    QWidget *w = mTable-&gt;cellWidget(src,i);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span>(!QString::compare(w-&gt;metaObject()-&gt;className(),<span class="string">"QComboBox"</span>))</span><br><span class="line">                    &#123;</span><br><span class="line">                        oldvals.append(((QComboBox*)w)-&gt;currentText());</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        oldvals.append(((QLineEdit*)w)-&gt;text());</span><br><span class="line">                    &#125;</span><br><span class="line">                    QObject::disconnect(w);</span><br><span class="line">                    mTable-&gt;removeCellWidget(src,i);</span><br><span class="line">                    w-&gt;deleteLater();</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                mTable-&gt;removeRow(src);</span><br><span class="line">                [...]</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            QAction  up(QIcon(<span class="string">":/icon/icons/act_up.png"</span>)  ,</span><br><span class="line">                        QString(<span class="string">"上移一行"</span>),this);</span><br><span class="line">            QObject::connect(&amp;up,</span><br><span class="line">                             &amp;QAction::triggered,[=]()&#123;</span><br><span class="line">                    sawp_lambda_func(line,line-1);</span><br><span class="line">            &#125;);</span><br><span class="line">  [...]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="模拟事件"><a href="#模拟事件" class="headerlink" title="模拟事件"></a>模拟事件</h1><ul>
<li><p>一些<code>GUI</code>的操作,需要一些事件来完成,下面模拟一个鼠标<code>Release</code>的事件</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[...]</span><br><span class="line"> QMouseEvent *event = new QMouseEvent(QMouseEvent::MouseButtonRelease,QCursor::pos(),</span><br><span class="line">                       Qt::LeftButton,Qt::LeftButton,Qt::NoModifier);</span><br><span class="line">     QApplication::postEvent(this,event);</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
</li>
<li><p>把事件转换成对其它控件的事件</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">void NewGrid::wheelEvent(QWheelEvent *event)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(sliderOrientation == Qt::Horizontal)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(event-&gt;orientation() != Qt::Horizontal)</span><br><span class="line">        &#123;</span><br><span class="line">            QWheelEvent  *evt = new QWheelEvent(event-&gt;pos(),event-&gt;globalPos(),</span><br><span class="line">                             event-&gt;delta(),</span><br><span class="line">                             event-&gt;buttons(),</span><br><span class="line">                             event-&gt;modifiers(),Qt::Horizontal);</span><br><span class="line">            QApplication::postEvent(mainScroll-&gt;horizontalScrollBar(),evt);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="元对像-动态属性"><a href="#元对像-动态属性" class="headerlink" title="元对像,动态属性"></a>元对像,动态属性</h1><p><strong>Meta-Object System 的基本功能</strong></p>
<ul>
<li><code>Meta Object System</code>的设计基于以下几个基础设施:</li>
<li><code>QObject</code>类<ul>
<li>作为每一个需要利用元对象系统的类的基类</li>
</ul>
</li>
<li><code>QOBJECT</code>宏<ul>
<li>定义在每一个类的私有数据段,用来启用元对象功能,比如,动态属性,信号和槽</li>
</ul>
</li>
<li>元对象编译器<code>moc (the Meta Object Complier)</code><ul>
<li>moc分析<code>C++</code>源文件,如果它发现在一个头文件(header file)中包含<code>Q_OBJECT</code>宏定义,然后动态的生成另外一个<code>C++</code>源文件,这个新的源文件包含<code>Q_OBJECT</code>实现代码,这个新的<code>C++</code>源文件也会被编译、链接到这个类的二进制代码中去,因为它也是这个类的完整的一部分.通常,这个新的<code>C++</code>源文件会在以前的<code>C++</code>源文件名前面加上<code>moc</code>作为新文件的文件名.其具体过程如下图所示:</li>
</ul>
</li>
<li>除了提供在对象间进行通讯的机制外,元对象系统还包含以下几种功能:<ul>
<li><code>QObject::metaObject()</code>方法<ul>
<li>它获得与一个类相关联的<code>meta-object</code><br>-<code>QMetaObject::className()</code>方法</li>
<li>在运行期间返回一个对象的类名,它不需要本地<code>C++</code>编译器的<code>RTTI(run-time type information)</code>支持</li>
</ul>
</li>
<li><code>QObject::inherits()</code>方法<ul>
<li>它用来判断生成一个对象类是不是从一个特定的类继承出来,当然,这必须是在<code>QObject</code>类的直接或者间接派生类当中</li>
</ul>
</li>
<li><code>QObject::tr()</code>and<code>QObject::trUtf8()</code><ul>
<li>这两个方法为软件的国际化翻译字符串</li>
</ul>
</li>
<li><code>QObject::setProperty()</code>and<code>QObject::property()</code><ul>
<li>这两个方法根据属性名动态的设置和获取属性值,读写属性</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QWidget *w = new QWidget()</span><br><span class="line">w-&gt;setProperty(<span class="string">"ABC1"</span>,4);</span><br><span class="line">w-&gt;setProperty(<span class="string">"ABC2"</span>,<span class="string">"dddddd"</span>);</span><br><span class="line"></span><br><span class="line">qDebug() &lt;&lt; w-&gt;property(<span class="string">"ABC1"</span>) &lt;&lt; w-&gt;property(<span class="string">"ABC2"</span>);</span><br></pre></td></tr></table></figure>
<h1 id="布署安装"><a href="#布署安装" class="headerlink" title="布署安装"></a>布署安装</h1><ul>
<li><p>对于开发QT程序来说,最好布署方法就是编译成静态执行文件,只是文件大一点.如果是动态编译就会有一些动态库链接路径的问题.比较特别的它要信赖<code>platforms</code>这个文件路经.可以通过 <strong>QCoreApplication::addLibraryPath(“C:/WINDOWS/System32”);</strong>来指定.</p>
</li>
<li><p><a href="https://download.qt.io/development_releases/installer-framework/2.0.3/" target="_blank" rel="noopener">下载安装</a></p>
</li>
<li><p><a href="http://doc.qt.io/qtinstallerframework/index.html" target="_blank" rel="noopener">参考文档</a>,从样本模版里复制一份出来做相应的修改.</p>
</li>
<li><p>一个安装包的目录结构如下:</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">D:\QtDev\QtInstaller\netmon-root&gt;tree /F</span><br><span class="line">卷 新加卷 的文件夹 PATH 列表</span><br><span class="line">卷序列号码为 0006EE44 E462:E6DB</span><br><span class="line">D:.</span><br><span class="line">│  build.bat</span><br><span class="line">│</span><br><span class="line">├─config</span><br><span class="line">│      config.xml</span><br><span class="line">│</span><br><span class="line">└─packages</span><br><span class="line">    └─com.vendor.product</span><br><span class="line">        ├─data</span><br><span class="line">        │  │  cares.dll</span><br><span class="line">        │  │  libcjson.dll</span><br><span class="line">        │  │  libcrypto-1_1.dll</span><br><span class="line">        │  │  libcurl.dll</span><br><span class="line">        │  │  libeay32_.dll</span><br><span class="line">        │  │  libgcc_s_dw2-1.dll</span><br><span class="line">        │  │  libmosquitto.dll</span><br><span class="line">        │  │  libssl-1_1.dll</span><br><span class="line">        │  │  libssp-0.dll</span><br><span class="line">        │  │  libstdc++-6.dll</span><br><span class="line">        │  │  libwinpthread-1.dll</span><br><span class="line">        │  │  libz_.dll</span><br><span class="line">        │  │  netmon-tray.exe</span><br><span class="line">        │  │  netmonui_i686.dll</span><br><span class="line">        │  │  <span class="built_in">print</span>-mon_i686.dll</span><br><span class="line">        │  │  qt.conf</span><br><span class="line">        │  │  Qt5Core.dll</span><br><span class="line">        │  │  Qt5Gui.dll</span><br><span class="line">        │  │  Qt5Network.dll</span><br><span class="line">        │  │  Qt5Widgets.dll</span><br><span class="line">        │  │  ssleay32_.dll</span><br><span class="line">        │  │</span><br><span class="line">        │  ├─imageformats</span><br><span class="line">        │  │      qdds.dll</span><br><span class="line">        │  │      qgif.dll</span><br><span class="line">        │  │      qicns.dll</span><br><span class="line">        │  │      qico.dll</span><br><span class="line">        │  │      qjpeg.dll</span><br><span class="line">        │  │      qsvg.dll</span><br><span class="line">        │  │      qtga.dll</span><br><span class="line">        │  │      qtiff.dll</span><br><span class="line">        │  │      qwbmp.dll</span><br><span class="line">        │  │      qwebp.dll</span><br><span class="line">        │  │</span><br><span class="line">        │  └─platforms</span><br><span class="line">        │          qminimal.dll</span><br><span class="line">        │          qoffscreen.dll</span><br><span class="line">        │          qwindows.dll</span><br><span class="line">        │</span><br><span class="line">        └─meta</span><br><span class="line">                installscript.qs</span><br><span class="line">                license.txt</span><br><span class="line">                package.xml</span><br><span class="line">                page.ui</span><br></pre></td></tr></table></figure>
<ul>
<li>package.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Package</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DisplayName</span>&gt;</span>显示名字<span class="tag">&lt;/<span class="name">DisplayName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Description</span>&gt;</span>随便写一些东西<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Version</span>&gt;</span>0.1.0-1<span class="tag">&lt;/<span class="name">Version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ReleaseDate</span>&gt;</span>2017-05-11<span class="tag">&lt;/<span class="name">ReleaseDate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Default</span>&gt;</span>script<span class="tag">&lt;/<span class="name">Default</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Script</span>&gt;</span>installscript.qs<span class="tag">&lt;/<span class="name">Script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">UserInterfaces</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">UserInterface</span>&gt;</span>page.ui<span class="tag">&lt;/<span class="name">UserInterface</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">UserInterfaces</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Package</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>config.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Installer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Name</span>&gt;</span>程序名字<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="name">Version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Title</span>&gt;</span>程序的抬头<span class="tag">&lt;/<span class="name">Title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Publisher</span>&gt;</span>yjdwbj@gmail.com<span class="tag">&lt;/<span class="name">Publisher</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">StartMenuDir</span>&gt;</span>网络打印客户端<span class="tag">&lt;/<span class="name">StartMenuDir</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TargetDir</span>&gt;</span>@ApplicationsDir@/NetMon<span class="tag">&lt;/<span class="name">TargetDir</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Installer</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>isntallscript.qs</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">function Component()</span><br><span class="line">&#123;</span><br><span class="line">    // constructor</span><br><span class="line">    component.loaded.connect(this, Component.prototype.loaded);</span><br><span class="line">    // 安装完成后自动连接到自动运行的函数</span><br><span class="line">   installer.installationFinished.connect(this,Component.prototype.InstallationFinishedAndRun);</span><br><span class="line">    installer.finishButtonClicked.connect(this,Component.prototype.installationFinished);</span><br><span class="line">   // if (!installer.addWizardPage(component, &quot;Page&quot;, QInstaller.TargetDirectory))</span><br><span class="line">   //     console.log(&quot;Could not add the dynamic page.&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Component.prototype.createOperations = function()</span><br><span class="line">&#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        // call the base create operations function</span><br><span class="line">        component.createOperations();</span><br><span class="line">        component.addOperation(&quot;CreateShortcut&quot;,&quot;C:/WINDOWS/System32/netmon-tray.exe&quot;,</span><br><span class="line">                                &quot;@StartMenuDir@/网络打印机客户端/网络打印机客户端.lnk&quot;,&quot;@workDirectory=@TargetDir@&quot;);</span><br><span class="line">        component.addOperation(&quot;CreateShortcut&quot;,&quot;@TargetDir@/maintenancetool.exe&quot;,</span><br><span class="line">                                                        &quot;@StartMenuDir@/网络打印机客户端/卸载.lnk&quot;,&quot;@workDirectory=@TargetDir@&quot;);</span><br><span class="line"></span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">        console.log(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Component.prototype.createOperationsForArchive = function(archive)</span><br><span class="line">&#123;</span><br><span class="line">    # packages\com.vendor.product\data　下面文件全部解压到system32里.</span><br><span class="line">    component.addOperation(&quot;Extract&quot;, archive, &quot;C:/WINDOWS/System32&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Version:1.0 StartHTML:0000000107 EndHTML:0000006210 StartFragment:0000000471 EndFragment:0000006172</span><br><span class="line">Component.prototype.InstallationFinishedAndRun = function()</span><br><span class="line">&#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        if(installer.isInstaller() &amp;&amp; installer.status == QInstaller.Success)</span><br><span class="line">        &#123;</span><br><span class="line">             installer.addWizardPageItem(component,&quot;Page&quot;,QInstaller.InstallationFinished);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">        console.log(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Component.prototype.installationFinished = function()</span><br><span class="line">&#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        if(installer.isInstaller() &amp;&amp; installer.status == QInstaller.Success)</span><br><span class="line">        &#123;</span><br><span class="line">            var isRun = component.userInterface(&quot;Page&quot;).runCheckbox.checked;</span><br><span class="line">            if(isRun)</span><br><span class="line">            &#123;</span><br><span class="line">                QDesktopServices.openUrl(&quot;C:/WINDOWS/System32/netmon-tray.exe&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">     console.log(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Page.ui</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;ui version=<span class="string">"4.0"</span>&gt;</span><br><span class="line"> &lt;class&gt;Page&lt;/class&gt;</span><br><span class="line"> &lt;widget class=<span class="string">"QWidget"</span> name=<span class="string">"Page"</span>&gt;</span><br><span class="line">  &lt;property name=<span class="string">"geometry"</span>&gt;</span><br><span class="line">   &lt;rect&gt;</span><br><span class="line">    &lt;x&gt;0&lt;/x&gt;</span><br><span class="line">    &lt;y&gt;0&lt;/y&gt;</span><br><span class="line">    &lt;width&gt;400&lt;/width&gt;</span><br><span class="line">    &lt;height&gt;300&lt;/height&gt;</span><br><span class="line">   &lt;/rect&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;property name=<span class="string">"windowTitle"</span>&gt;</span><br><span class="line">   &lt;string&gt;Dynamic page example&lt;/string&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;layout class=<span class="string">"QVBoxLayout"</span> name=<span class="string">"verticalLayout"</span>&gt;</span><br><span class="line">   &lt;item&gt;</span><br><span class="line">    &lt;widget class=<span class="string">"QLabel"</span> name=<span class="string">"m_pageLabel"</span>&gt;</span><br><span class="line">     &lt;property name=<span class="string">"alignment"</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">set</span>&gt;Qt::AlignCenter&lt;/<span class="built_in">set</span>&gt;</span><br><span class="line">     &lt;/property&gt;</span><br><span class="line">    &lt;/widget&gt;</span><br><span class="line">   &lt;/item&gt;</span><br><span class="line">   &lt;item&gt;</span><br><span class="line">    &lt;widget class=<span class="string">"QCheckBox"</span> name=<span class="string">"runCheckbox"</span>&gt;</span><br><span class="line">     &lt;property name=<span class="string">"text"</span>&gt;</span><br><span class="line">     &lt;string&gt;安装完成后,运行该程序&lt;/string&gt;</span><br><span class="line">     &lt;/property&gt;</span><br><span class="line">     &lt;property name=<span class="string">"checked"</span>&gt;</span><br><span class="line">     &lt;bool&gt;<span class="literal">true</span>&lt;/bool&gt;</span><br><span class="line">     &lt;/property&gt;</span><br><span class="line">     &lt;property name=<span class="string">"tristate"</span>&gt;</span><br><span class="line">     &lt;bool&gt;<span class="literal">false</span>&lt;/bool&gt;</span><br><span class="line">     &lt;/property&gt;</span><br><span class="line">    &lt;/widget&gt;</span><br><span class="line">   &lt;/item&gt;</span><br><span class="line">  &lt;/layout&gt;</span><br><span class="line"> &lt;/widget&gt;</span><br><span class="line"> &lt;resources/&gt;</span><br><span class="line"> &lt;connections/&gt;</span><br><span class="line">&lt;/ui&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>最后这里用一行脚本来生成一键安装包文件.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binarycreator --offline-only -c D:\QtDev\QtInstaller\netmon-root\config\config.xml -p D:\QtDev\QtInstaller\netmon-root\packages  <span class="string">"Z:/upload/appname－测试版%DATE%－%TIME::=_%.exe"</span></span><br></pre></td></tr></table></figure>
<h1 id="调试变量"><a href="#调试变量" class="headerlink" title="调试变量"></a>调试变量</h1><ul>
<li><p><code>Qt plugin</code>版本不兼容的问题,有时<code>Qt</code>莫名闪退,需设置<code>export QT_DEBUG_PLUGINS=1</code>,方可以看下面的加载.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Found metadata <span class="keyword">in</span> lib /fullpath/plugins/sqldrivers/libqsqlite.so, metadata=</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"IID"</span>: <span class="string">"org.qt-project.Qt.QSqlDriverFactoryInterface"</span>,</span><br><span class="line">    <span class="string">"MetaData"</span>: &#123;</span><br><span class="line">        <span class="string">"Keys"</span>: [</span><br><span class="line">            <span class="string">"QSQLITE"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"archreq"</span>: 0,</span><br><span class="line">    <span class="string">"className"</span>: <span class="string">"QSQLiteDriverPlugin"</span>,</span><br><span class="line">    <span class="string">"debug"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="string">"version"</span>: 331264</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Got keys from plugin meta data (<span class="string">"QSQLITE"</span>)</span><br><span class="line">QFactoryLoader::QFactoryLoader() looking at <span class="string">"/fullpath/plugins/sqldrivers/libsqlitecipher.</span></span><br><span class="line"><span class="string">Found metadata in lib /fullpath/plugins/sqldrivers/libsqlitecipher.so, metadata=</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    "</span>IID<span class="string">": "</span>org.qt-project.Qt.QSqlDriverFactoryInterface<span class="string">",</span></span><br><span class="line"><span class="string">    "</span>MetaData<span class="string">": &#123;</span></span><br><span class="line"><span class="string">        "</span>Keys<span class="string">": [</span></span><br><span class="line"><span class="string">            "</span>SQLITECIPHER<span class="string">"</span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    "</span>className<span class="string">": "</span>SqliteCipherDriverPlugin<span class="string">",</span></span><br><span class="line"><span class="string">    "</span>debug<span class="string">": false,</span></span><br><span class="line"><span class="string">    "</span>version<span class="string">": 330499</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用<code>export QT_FATAL_WARNINGS=1</code>,可以让程序的在警告的位置崩溃退出,并打印调用<code>stack frame</code>.</p>
</li>
<li><code>Could not initialize GLX</code> 错误,尝试设置 <code>export QT_XCB_GL_INTEGRATION=none</code>是可以处理.</li>
<li><code>export USE_WOLFRAM_LD_LIBRARY_PATH=1</code></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QXcbIntegration: Cannot create platform OpenGL context, neither GLX nor EGL are enabled</span><br></pre></td></tr></table></figure>
<ul>
<li><p>关于跨平台的一些全局宏定义如:<code>Q_OS_WIN,Q_OS_MAC,...</code>可以查询参考<a href="https://doc.qt.io/qt-5/qtglobal.html" target="_blank" rel="noopener">https://doc.qt.io/qt-5/qtglobal.html</a></p>
</li>
<li><p>对于工程内的模块,不要加上<code>CONFIG += debug_and_release</code>或者<code>CONFIG += build_all</code>配置,除非是要把它做动态库发布出去的文件,否则这只会增加编译时间,编译了一些必要的对像.</p>
</li>
</ul>
<h2 id="QtCreator调试设置"><a href="#QtCreator调试设置" class="headerlink" title="QtCreator调试设置"></a><code>QtCreator</code>调试设置</h2><ul>
<li><code>QtCreator</code>的调试插件<a href="https://doc.qt.io/qtcreator/creator-debugging-helpers.html" target="_blank" rel="noopener">Using Debugging Helpers</a>,可以参考它,对<code>GDB</code>做一些调脚本.常规选项如,<code>Debugger -&gt; Locals &amp; Expressions -&gt; Display string legnth</code>,默认<code>100</code>字节,可能对于调一些大的<code>json</code>结构体会不够.</li>
</ul>
<h1 id="Visual-Studio上的开发"><a href="#Visual-Studio上的开发" class="headerlink" title="Visual Studio上的开发"></a><code>Visual Studio</code>上的开发</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul>
<li>通过<a href="https://visualstudio.microsoft.com/zh-hans/thank-you-downloading-visual-studio/?sku=Community&amp;rel=16" target="_blank" rel="noopener">下载Visual Studio Community</a>安装,在安装时需要注意的是,除了安装相应的开发工具套件外,还应该安装<code>开发-扩展(Visual Studio extension develepoment)</code>,通过它可以安装一些高效开发插件,如: <a href="https://marketplace.visualstudio.com/items?itemName=TheQtCompany.QtVisualStudioTools-19123" target="_blank" rel="noopener">Qt Visual Studio Tools</a>,<a href="https://marketplace.visualstudio.com/items?itemName=ArkadyShapkin.CDebuggerVisualizersforVS2019" target="_blank" rel="noopener">C++ Debugger Visualizers for VS2019</a>,支持<code>Qt</code>调试查看对像内容.</li>
</ul>
<h2 id="导入Qt工程"><a href="#导入Qt工程" class="headerlink" title="导入Qt工程"></a>导入<code>Qt</code>工程</h2><ul>
<li><code>msvc</code>也是一个很复杂,很高效的开发工具,如果在windows上调试,还是为它最合适,比竟都是它自家的东西.所以可以通过使用<code>qmake -tp vc -r   &lt;your project&gt;.pro</code>的方式,把<code>Qt</code>工程转换成<code>msvc</code>工程,转换后的工程,可能需要少许的手动修改.</li>
<li>把<code>cl.exe</code>所在位置加入到,系统<code>Path</code>变量里去,用<code>power shell</code>运行<code>qmake -tp vc ../your-project.pro</code>.</li>
<li>或者,通过<code>开始</code>菜单,找到<code>Visual Studio 2019</code>目录,运行<code>x86 Native Tools Command Prompt for VS 2019</code>, 切换到工程目录运行<code>qmake -tp vc</code>.</li>
<li><p>或者,进入<code>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build</code>,运行相应的环境Shell.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">cd</span> <span class="string">"C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build"</span></span><br><span class="line">PS C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build&gt; ls</span><br><span class="line"></span><br><span class="line">    目录: C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">d-----         2021/5/11      9:26                14.16</span><br><span class="line">-a----         2021/5/11      9:20             13 Microsoft.VCRedistVersion.default.txt</span><br><span class="line">-a----         2021/5/11      9:20            393 Microsoft.VCToolsVersion.default.props</span><br><span class="line">-a----         2021/5/11      9:20             13 Microsoft.VCToolsVersion.default.txt</span><br><span class="line">-a----         2021/5/11      9:26            401 Microsoft.VCToolsVersion.v141.default.props</span><br><span class="line">-a----         2021/5/11      9:26             13 Microsoft.VCToolsVersion.v141.default.txt</span><br><span class="line">-a----         2021/5/11      9:20            401 Microsoft.VCToolsVersion.v142.default.props</span><br><span class="line">-a----         2021/5/11      9:20             13 Microsoft.VCToolsVersion.v142.default.txt</span><br><span class="line">-a----         2021/5/11      9:20             39 vcvars32.bat</span><br><span class="line">-a----         2021/5/11      9:20             39 vcvars64.bat</span><br><span class="line">-a----         2021/5/11      9:20           9859 vcvarsall.bat</span><br><span class="line">-a----         2021/5/11      9:20             43 vcvarsamd64_x86.bat</span><br><span class="line">-a----         2021/5/11      9:20             43 vcvarsx86_amd64.bat</span><br></pre></td></tr></table></figure>
</li>
<li><p>命令行编译QT,<br><a href="https://medium.com/@hiennguyen92/build-qt-command-line-for-window-f03d9047869c" target="_blank" rel="noopener">Build QT Command Line for Window</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qmake -spec win32-msvc <span class="string">"CONFIG+=qtquickcompiler"</span> ../src/youduqt.pro</span><br></pre></td></tr></table></figure>
</li>
<li><p>为<code>UTF-8</code>类型添加<code>BOM</code>标识,因为<code>windows</code>下有些程序需要认它.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span> <span class="string">'\xEF\xBB\xBF'</span> &gt; report_new.csv</span><br><span class="line">cat report &gt;&gt; report_new.csv</span><br></pre></td></tr></table></figure>
</li>
<li><p>或者这样</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">'1s/^/\xef\xbb\xbf/'</span> file-encoded-with-utf8.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>vs2019</code>奇怪错误,<code>vs2019 C1075</code>, 这个问题在<code>Linux</code>下编译正常,在<code>windows</code>下出错,这是因为这个文件是在<code>Linux</code>下创建,不是<code>UTF8-BOM</code>,所以才出错.这是在不系统下切换开发环境才会碰到的.</p>
</li>
</ul>
<h2 id="调试设置"><a href="#调试设置" class="headerlink" title="调试设置"></a>调试设置</h2><ul>
<li><a href="https://wiki.qt.io/IDE_Debug_Helpers" target="_blank" rel="noopener">IDE_Debug_Helpers</a></li>
<li><a href="https://github.com/inviwo/inviwo/tree/master/tools/natvis" target="_blank" rel="noopener">Natvis</a></li>
<li>把一些<code>*.natvis</code>文件放入到<code>C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\Common7\Packages\Debugger\Visualizers</code>里.可以支持调试<code>Qt</code>工程序时,查看对像内的内容,而不是一个指针值.</li>
</ul>
<h1 id="一些工程总结"><a href="#一些工程总结" class="headerlink" title="一些工程总结"></a>一些工程总结</h1><ul>
<li>工程拆分模块,尽量可以动/静态库的方式链接或者耦合,面向接口编程.</li>
<li>对于可以共用的模块功能,中间的类名,尽量以抽像方式命名,不要带有具体名称,尤其是产品名,公司名.如果要把它移到别的产品就会有点别扭.</li>
<li>对于一些相同功能的类,又没有共同继父类的,类之间尽量不要有全名匹配相同的函数名,当工程到了一规模时,搜索函数名时可以高效过滤找到.</li>
<li>对于大的工程,尽量不要滥用,如:<code>use namespace std;</code>, 对于规模比较大的工程,文件行数多时,在<code>review</code>时无法直观知道它所属的命名空间,而因此碰到<code>命名冲突的概率</code>也很高.</li>
<li>成员变量必须要有一个前缀,如:<code>m_XXXXX</code>,方便有别于局部变量区分.</li>
</ul>
<h1 id="错误总结"><a href="#错误总结" class="headerlink" title="错误总结"></a>错误总结</h1><ul>
<li><code>Qt5</code>加载<code>QSS</code>资源问题,这个是因为<code>QSS</code>的语法或者配置错误所造成的,会使整个<code>QSS</code>环境坏了.遇到过因为<code>border-image: url(:/x_wnd/home_086@2x.png);</code>而出现下面错误.因为<code>url</code>里的路径里含有<code>@</code>字符,对于路径最好是用双引号(“”)包括起来.而一般的UI工程师切图导出的文件,就是带<code>@</code>符号来区分尺寸的.但是发现在<code>QT C++</code>里写<code>obj-&gt;setButtonImage(&quot;:/main_wnd/new/02_003_01@2x.png&quot;);</code>是可以识别,是正常可行的.<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Could not parse stylesheet of object 0x55dabc30bd60</span><br><span class="line">Could not parse stylesheet of object 0x55dabc2e8220</span><br><span class="line">Could not parse stylesheet of object 0x55dabc30bd60</span><br><span class="line">Could not parse stylesheet of object 0x55dabc30bd60</span><br><span class="line">Could not parse stylesheet of object 0x55dabc30bd60</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="QWebChannel使用"><a href="#QWebChannel使用" class="headerlink" title="QWebChannel使用"></a>QWebChannel使用</h1><h1 id="谢谢支持"><a href="#谢谢支持" class="headerlink" title="谢谢支持"></a>谢谢支持</h1><ul>
<li>微信二维码:</li>
<li><a href="mailto:yjdwbj@gmail.com" target="_blank" rel="noopener">联系作者</a></li>
</ul>
<p><img src="/imgs/mm_reward_qrcode_1525013906055.png" width="40%" height="40%" align="center/"></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2016/12/22/安装Postgresql-XL/" rel="prev" title="安装Postgresql-XL">
      <i class="fa fa-chevron-left"></i> 安装Postgresql-XL
    </a></div>
      <div class="post-nav-item">
    <a href="/2017/01/15/栽剪FFMPEG做GIF录屏工具/" rel="next" title="栽剪FFMPEG做GIF录屏工具">
      栽剪FFMPEG做GIF录屏工具 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Lambda-匿名函数"><span class="nav-number">1.</span> <span class="nav-text">Lambda 匿名函数</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#模拟事件"><span class="nav-number">2.</span> <span class="nav-text">模拟事件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#元对像-动态属性"><span class="nav-number">3.</span> <span class="nav-text">元对像,动态属性</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#布署安装"><span class="nav-number">4.</span> <span class="nav-text">布署安装</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#调试变量"><span class="nav-number">5.</span> <span class="nav-text">调试变量</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#QtCreator调试设置"><span class="nav-number">5.1.</span> <span class="nav-text">QtCreator调试设置</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Visual-Studio上的开发"><span class="nav-number">6.</span> <span class="nav-text">Visual Studio上的开发</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装"><span class="nav-number">6.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#导入Qt工程"><span class="nav-number">6.2.</span> <span class="nav-text">导入Qt工程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#调试设置"><span class="nav-number">6.3.</span> <span class="nav-text">调试设置</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#一些工程总结"><span class="nav-number">7.</span> <span class="nav-text">一些工程总结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#错误总结"><span class="nav-number">8.</span> <span class="nav-text">错误总结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#QWebChannel使用"><span class="nav-number">9.</span> <span class="nav-text">QWebChannel使用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#谢谢支持"><span class="nav-number">10.</span> <span class="nav-text">谢谢支持</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="yjdwbj"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">yjdwbj</p>
  <div class="site-description" itemprop="description">最是人间留不住,朱颜辞镜花辞树</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">50</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yjdwbj</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

</body>
</html>
