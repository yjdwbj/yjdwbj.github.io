<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Links: fpgarduino talking-to-the-de0-nano-using-the-virtual-jtag-interface Altera_Design_Software   OpenRISC OpenRISC Linux FuseSoC FuseSoC standard core library Getting started with OpenRISC on Alte">
<meta name="keywords" content="FPGA,RISC-V,Linux">
<meta property="og:type" content="article">
<meta property="og:title" content="玩转FPGA_DE0-Nano">
<meta property="og:url" content="http://yoursite.com/2021/02/02/玩转FPGA-DE0-Nano/index.html">
<meta property="og:site_name" content="Sunrise 博客">
<meta property="og:description" content="Links: fpgarduino talking-to-the-de0-nano-using-the-virtual-jtag-interface Altera_Design_Software   OpenRISC OpenRISC Linux FuseSoC FuseSoC standard core library Getting started with OpenRISC on Alte">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/imgs/de0-nano-jtag-block.png">
<meta property="og:image" content="http://yoursite.com/imgs/quartus-20.1-installation.png">
<meta property="og:image" content="http://yoursite.com/imgs/mm_reward_qrcode_1525013906055.png">
<meta property="og:updated_time" content="2022-03-19T08:27:56.956Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="玩转FPGA_DE0-Nano">
<meta name="twitter:description" content="Links: fpgarduino talking-to-the-de0-nano-using-the-virtual-jtag-interface Altera_Design_Software   OpenRISC OpenRISC Linux FuseSoC FuseSoC standard core library Getting started with OpenRISC on Alte">
<meta name="twitter:image" content="http://yoursite.com/imgs/de0-nano-jtag-block.png">

<link rel="canonical" href="http://yoursite.com/2021/02/02/玩转FPGA-DE0-Nano/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>玩转FPGA_DE0-Nano | Sunrise 博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Sunrise 博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/02/02/玩转FPGA-DE0-Nano/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="yjdwbj">
      <meta itemprop="description" content="最是人间留不住,朱颜辞镜花辞树">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sunrise 博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          玩转FPGA_DE0-Nano
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-02-02 19:01:27" itemprop="dateCreated datePublished" datetime="2021-02-02T19:01:27+08:00">2021-02-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-19 16:27:56" itemprop="dateModified" datetime="2022-03-19T16:27:56+08:00">2022-03-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <ul>
<li>Links:<ul>
<li><a href="http://www.nxlab.fer.hr/fpgarduino/" target="_blank" rel="noopener">fpgarduino</a></li>
<li><a href="https://idlelogiclabs.com/2012/04/15/talking-to-the-de0-nano-using-the-virtual-jtag-interface/" target="_blank" rel="noopener">talking-to-the-de0-nano-using-the-virtual-jtag-interface</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Altera_Design_Software" target="_blank" rel="noopener">Altera_Design_Software</a></li>
</ul>
<ul>
<li>OpenRISC<ul>
<li><a href="https://www.kernel.org/doc/html/latest/openrisc/openrisc_port.html" target="_blank" rel="noopener">OpenRISC Linux</a></li>
<li><a href="https://github.com/olofk/fusesoc" target="_blank" rel="noopener">FuseSoC</a></li>
<li><a href="https://github.com/fusesoc/fusesoc-cores" target="_blank" rel="noopener">FuseSoC standard core library</a></li>
<li><a href="https://matbaj.github.io/2015/01/19/openrisc-on-de2-115/" target="_blank" rel="noopener">Getting started with OpenRISC on Altera Terasic de2-115 board</a></li>
<li><a href="https://kevinmehall.net/openrisc/guide/" target="_blank" rel="noopener">Getting Started with OpenRISC</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="开板板简介"><a href="#开板板简介" class="headerlink" title="开板板简介"></a>开板板简介</h1><h2 id="管脚定义"><a href="#管脚定义" class="headerlink" title="管脚定义"></a>管脚定义</h2><ul>
<li>下面数据来源于<code>DE0_Nano_User_Manual.pdf</code>的<code>Chapter 3-3.5 Expansion headers</code>.</li>
</ul>
<h3 id="GPIO-0-Pin-Assignments"><a href="#GPIO-0-Pin-Assignments" class="headerlink" title="GPIO-0 Pin Assignments"></a>GPIO-0 Pin Assignments</h3><table>
<thead>
<tr>
<th>Signal Name</th>
<th>FPGA Pin No.</th>
<th>Descritption</th>
<th>I/O Standard</th>
</tr>
</thead>
<tbody>
<tr>
<td>GPIO_0_IN0</td>
<td>PIN_A8</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_00</td>
<td>PIN_D3</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_0_IN1</td>
<td>PIN_B8</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_01</td>
<td>PIN_C3</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_02</td>
<td>PIN_A2</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_03</td>
<td>PIN_A3</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_04</td>
<td>PIN_B3</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_05</td>
<td>PIN_B4</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_06</td>
<td>PIN_A4</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_07</td>
<td>PIN_B5</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_08</td>
<td>PIN_A5</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_09</td>
<td>PIN_D5</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_010</td>
<td>PIN_B6</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_011</td>
<td>PIN_A6</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_012</td>
<td>PIN_B7</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_013</td>
<td>PIN_D6</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_014</td>
<td>PIN_A7</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_015</td>
<td>PIN_C6</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_016</td>
<td>PIN_C8</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_017</td>
<td>PIN_E6</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_018</td>
<td>PIN_E7</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_019</td>
<td>PIN_D8</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_020</td>
<td>PIN_E8</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_021</td>
<td>PIN_F8</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_022</td>
<td>PIN_F9</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_023</td>
<td>PIN_E9</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_024</td>
<td>PIN_C9</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_025</td>
<td>PIN_D9</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_026</td>
<td>PIN_E11</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_027</td>
<td>PIN_E10</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_028</td>
<td>PIN_C11</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_029</td>
<td>PIN_B11</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_030</td>
<td>PIN_A12</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_031</td>
<td>PIN_D11</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_032</td>
<td>PIN_D12</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_033</td>
<td>PIN_B12</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
</tbody>
</table>
<h3 id="GPIO-1-Pin-Assignments"><a href="#GPIO-1-Pin-Assignments" class="headerlink" title="GPIO-1 Pin Assignments"></a>GPIO-1 Pin Assignments</h3><table>
<thead>
<tr>
<th>Signal Name</th>
<th>FPGA Pin No.</th>
<th>Descritption</th>
<th>I/O Standard</th>
</tr>
</thead>
<tbody>
<tr>
<td>GPIO_1_IN0</td>
<td>PIN_T9</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_10</td>
<td>PIN_F13</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_1_IN1</td>
<td>PIN_R9</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_11</td>
<td>PIN_T15</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_12</td>
<td>PIN_T14</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_13</td>
<td>PIN_T13</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_14</td>
<td>PIN_R13</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_15</td>
<td>PIN_T12</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_16</td>
<td>PIN_R12</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_17</td>
<td>PIN_T11</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_18</td>
<td>PIN_T10</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_19</td>
<td>PIN_R11</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_110</td>
<td>PIN_P11</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_111</td>
<td>PIN_R10</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_112</td>
<td>PIN_N12</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_113</td>
<td>PIN_P9</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_114</td>
<td>PIN_N9</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_115</td>
<td>PIN_N11</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_116</td>
<td>PIN_L16</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_117</td>
<td>PIN_K16</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_118</td>
<td>PIN_R16</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_119</td>
<td>PIN_L15</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_120</td>
<td>PIN_P15</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_121</td>
<td>PIN_P16</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_122</td>
<td>PIN_R14</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_123</td>
<td>PIN_N16</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_124</td>
<td>PIN_N15</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_125</td>
<td>PIN_P14</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_126</td>
<td>PIN_L14</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_127</td>
<td>PIN_N14</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_128</td>
<td>PIN_M10</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_129</td>
<td>PIN_L13</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_130</td>
<td>PIN_J16</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_131</td>
<td>PIN_K15</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_132</td>
<td>PIN_J13</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_133</td>
<td>PIN_J14</td>
<td>GPIO Connection DATA</td>
<td>3.3V</td>
</tr>
</tbody>
</table>
<h3 id="Table-3-8-Pin-Assignments-for-2x13-Header"><a href="#Table-3-8-Pin-Assignments-for-2x13-Header" class="headerlink" title="Table 3-8 Pin Assignments for 2x13 Header"></a>Table 3-8 Pin Assignments for 2x13 Header</h3><table>
<thead>
<tr>
<th>Signal Name</th>
<th>FPGA Pin No.</th>
<th>Descritption</th>
<th>I/O Standard</th>
</tr>
</thead>
<tbody>
<tr>
<td>GPIO_2[0]</td>
<td>PIN_A14</td>
<td>GPIO Connection DATA[0]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[1]</td>
<td>PIN_B16</td>
<td>GPIO Connection DATA[1]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[2]</td>
<td>PIN_C14</td>
<td>GPIO Connection DATA[2]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[3]</td>
<td>PIN_C16</td>
<td>GPIO Connection DATA[3]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[4]</td>
<td>PIN_C15</td>
<td>GPIO Connection DATA[4]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[5]</td>
<td>PIN_D16</td>
<td>GPIO Connection DATA[5]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[6]</td>
<td>PIN_D15</td>
<td>GPIO Connection DATA[6]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[7]</td>
<td>PIN_D14</td>
<td>GPIO Connection DATA[7]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[8]</td>
<td>PIN_F15</td>
<td>GPIO Connection DATA[8]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[9]</td>
<td>PIN_F16</td>
<td>GPIO Connection DATA[9]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[10]</td>
<td>PIN_F14</td>
<td>GPIO Connection DATA[10]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[11]</td>
<td>PIN_G16</td>
<td>GPIO Connection DATA[11]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2[12]</td>
<td>PIN_G15</td>
<td>GPIO Connection DATA[12]</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2_IN[0]</td>
<td>PIN_E15</td>
<td>GPIO Input</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2_IN[1]</td>
<td>PIN_E16</td>
<td>GPIO Input</td>
<td>3.3V</td>
</tr>
<tr>
<td>GPIO_2_IN[2]</td>
<td>PIN_M16</td>
<td>GPIO Input</td>
<td>3.3V</td>
</tr>
</tbody>
</table>
<h3 id="Table-3-9-Pin-Assignments-for-ADC"><a href="#Table-3-9-Pin-Assignments-for-ADC" class="headerlink" title="Table 3-9 Pin Assignments for ADC"></a>Table 3-9 Pin Assignments for ADC</h3><table>
<thead>
<tr>
<th>Signal Name</th>
<th>FPGA Pin No.</th>
<th>Descritption</th>
<th>I/O Standard</th>
</tr>
</thead>
<tbody>
<tr>
<td>ADC_CS_N</td>
<td>PIN_A10</td>
<td>Chip select</td>
<td>3.3V</td>
</tr>
<tr>
<td>ADC_SADDR</td>
<td>PIN_B10</td>
<td>Digital data input</td>
<td>3.3V</td>
</tr>
<tr>
<td>ADC_SDAT</td>
<td>PIN_A9</td>
<td>Digital data output</td>
<td>3.3V</td>
</tr>
<tr>
<td>ADC_SCLK</td>
<td>PIN_B14</td>
<td>Digital clock input</td>
<td>3.3V</td>
</tr>
</tbody>
</table>
<h3 id="JTAG"><a href="#JTAG" class="headerlink" title="JTAG"></a>JTAG</h3><p><img src="/imgs/de0-nano-jtag-block.png" alt="de0-nano-jtag-block.png"></p>
<h1 id="OpenRisc"><a href="#OpenRisc" class="headerlink" title="OpenRisc"></a>OpenRisc</h1><h2 id="GCC工具链"><a href="#GCC工具链" class="headerlink" title="GCC工具链"></a>GCC工具链</h2><ul>
<li><a href="https://github.com/stffrdhrn/or1k-toolchain-build" target="_blank" rel="noopener">or1k-toolchain-build</a></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~$ git <span class="built_in">clone</span> https://github.com/stffrdhrn/or1k-toolchain-build</span><br><span class="line">~$ <span class="built_in">cd</span> or1k-toolchain-build</span><br><span class="line">~$ docker build -t or1k-toolchain-build or1k-toolchain-build/</span><br></pre></td></tr></table></figure>
<ul>
<li>设置挂载目录变量,运行容器编译.如果<code>build-gcc.sh</code>内的资源链接失效了,需要找一个替代修改它,如：<code>QEMU_URL=https://github.com/vamanea/qemu-or32/archive/v2.0.2.tar.gz</code>.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The location where you have tarballs, so they dont need to be</span></span><br><span class="line"><span class="comment"># downloaded every time you build</span></span><br><span class="line">CACHEDIR=/home/user/work/docker/volumes/src</span><br><span class="line"><span class="comment"># The location where you want your output to go</span></span><br><span class="line">OUTPUTDIR=/home/user/work/docker/volumes/crosstool</span><br><span class="line"></span><br><span class="line">docker run -it --rm \</span><br><span class="line">  -e MUSL_ENABLED=1 \</span><br><span class="line">  -e NEWLIB_ENABLED=1 \</span><br><span class="line">  -e NOLIB_ENABLED=1 \</span><br><span class="line">  -e GCC_VERSION=9.0.1 \</span><br><span class="line">  -e BINUTILS_VERSION=2.32.51 \</span><br><span class="line">  -e LINUX_HEADERS_VERSION=4.19.1 \</span><br><span class="line">  -e MUSL_VERSION=1.1.20 \</span><br><span class="line">  -e GMP_VERSION=6.1.2 \</span><br><span class="line">  -v <span class="variable">$&#123;OUTPUTDIR&#125;</span>:/opt/crosstool:Z \</span><br><span class="line">  -v <span class="variable">$&#123;CACHEDIR&#125;</span>:/opt/crossbuild/cache:Z \</span><br><span class="line">    or1k-toolchain-build</span><br></pre></td></tr></table></figure>
<ul>
<li>编译成功后,如下：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ls</span><br><span class="line">or1k-elf-9.0.1-20210204.tar.xz</span><br><span class="line">or1k-elf-gcc-9.0.1-20210204.log.gz</span><br><span class="line">or1k-elf-gcc-9.0.1-20210204.sum</span><br><span class="line">or1k-elf-gxx-9.0.1-20210204.log.gz</span><br><span class="line">or1k-elf-gxx-9.0.1-20210204.sum</span><br><span class="line">or1k-linux-9.0.1-20210204.tar.xz</span><br><span class="line">or1k-linux-musl-9.0.1-20210204.tar.xz</span><br><span class="line">or1k-linux-musl-gcc-9.0.1-20210203.log.gz</span><br><span class="line">or1k-linux-musl-gcc-9.0.1-20210203.sum</span><br><span class="line">or1k-linux-musl-gcc-9.0.1-20210204.log.gz</span><br><span class="line">or1k-linux-musl-gcc-9.0.1-20210204.sum</span><br><span class="line">or1k-linux-musl-gxx-9.0.1-20210203.log.gz</span><br><span class="line">or1k-linux-musl-gxx-9.0.1-20210203.sum</span><br><span class="line">or1k-linux-musl-gxx-9.0.1-20210204.log.gz</span><br><span class="line">or1k-linux-musl-gxx-9.0.1-20210204.sum</span><br><span class="line">relnotes-9.0.1-20210204.md</span><br></pre></td></tr></table></figure>
<ul>
<li><p>这里把<code>or1k-linux-9.0.1-20210204.tar.xz</code>解压安装到本地,并设置相应的环境变量如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> ALTERA_PATH=<span class="string">"/home/michael/3TB-DISK/intelFPGA_lite/20.1/"</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ALTERA_PATH</span>/quartus/bin</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> ARCH=openrisc</span><br><span class="line"><span class="built_in">export</span> CROSS_COMPILE=or1k-linux-</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:`<span class="built_in">pwd</span>`/toolchain-rootfs/or1k-linux/bin</span><br></pre></td></tr></table></figure>
</li>
<li><p>或者单独编译<code>or1k-gcc</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~$ git <span class="built_in">clone</span> https://github.com/openrisc/or1k-gcc</span><br><span class="line">~$ <span class="built_in">cd</span> or1k-gcc/</span><br><span class="line">~$ mkdir build-linux</span><br><span class="line">~$ <span class="built_in">cd</span> build-linux &amp;&amp; ../configure &amp;&amp; make -j4</span><br><span class="line">~$ make install DESTPATH=&lt;absolute  path&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="编译ORPSOC"><a href="#编译ORPSOC" class="headerlink" title="编译ORPSOC"></a>编译<code>ORPSOC</code></h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~$ git <span class="built_in">clone</span> https://github.com/mczerski/orpsoc-de0_nano</span><br><span class="line">~$ <span class="built_in">export</span> ALTERA_PATH=<span class="string">"/home/fullpath/QuartusIIWebEdition13.0.0.156/quartus"</span></span><br><span class="line">~$ <span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$ALTERA_PATH</span>/bin</span><br><span class="line">~$ make OR32_TOOL_PREFIX=or1k-linux- all</span><br></pre></td></tr></table></figure>
<h2 id="编译Linux"><a href="#编译Linux" class="headerlink" title="编译Linux"></a>编译Linux</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">~$ tar xvf linux-4.16.14.tar.xz</span><br><span class="line">~$ <span class="built_in">cd</span> linux-4.16.14</span><br><span class="line">~$ wget -c https://kevinmehall.net/openrisc/guide/de0_nano.dts.txt -O arch/openrisc/boot/dts/de0_nano.dts</span><br><span class="line"></span><br><span class="line">~$ make ARCH=openrisc CROSS_COMPILE=<span class="string">"or1k-linux-"</span> or1ksim_defconfig</span><br><span class="line">/** Select Processor <span class="built_in">type</span> and Features -&gt; Builtin DTB and <span class="built_in">type</span> de0_nano */</span><br><span class="line">~$ make ARCH=openrisc CROSS_COMPILE=<span class="string">"or1k-linux-"</span> menuconfig</span><br><span class="line">~$ make ARCH=openrisc CROSS_COMPILE=<span class="string">"or1k-linux-"</span></span><br></pre></td></tr></table></figure>
<h2 id="烧写入bitstream"><a href="#烧写入bitstream" class="headerlink" title="烧写入bitstream"></a>烧写入bitstream</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~$ <span class="built_in">cd</span> orpsoc/boards/altera/de0_nano/syn/quartus/run</span><br><span class="line">~$ make OR32_TOOL_PREFIX=or1k-linux- all</span><br><span class="line">~$ make pgm</span><br></pre></td></tr></table></figure>
<h2 id="连接串号"><a href="#连接串号" class="headerlink" title="连接串号"></a>连接串号</h2><ul>
<li>根据上面<code>GPIO</code>的管脚定义,以及下面的信息,连接正确的<code>rx,tx</code>.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat boards/altera/de0_nano/syn/quartus/tcl/UART0_pin_assignments.tcl</span><br><span class="line">set_location_assignment PIN_D8 -to uart0_srx_pad_i</span><br><span class="line">set_instance_assignment -name IO_STANDARD <span class="string">"3.3-V LVTTL"</span> -to uart0_srx_pad_i</span><br><span class="line">set_location_assignment PIN_F8 -to uart0_stx_pad_o</span><br><span class="line">set_instance_assignment -name IO_STANDARD <span class="string">"3.3-V LVTTL"</span> -to uart0_stx_pad_o</span><br></pre></td></tr></table></figure>
<h1 id="FuseSOC-试用"><a href="#FuseSOC-试用" class="headerlink" title="FuseSOC 试用"></a>FuseSOC 试用</h1><ul>
<li><a href="https://fusesoc.readthedocs.io/en/stable/user/index.html" target="_blank" rel="noopener">FuseSoC User Guide</a></li>
<li><a href="https://stffrdhrn.github.io/hardware/embedded/openrisc/2019/06/11/or1k_marocchino.html" target="_blank" rel="noopener">OR1K Marocchino in Action</a></li>
</ul>
<h2 id="安装fuseSoc"><a href="#安装fuseSoc" class="headerlink" title="安装fuseSoc"></a>安装fuseSoc</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">~$ git <span class="built_in">clone</span> https://github.com/olofk/fusesoc</span><br><span class="line"></span><br><span class="line">~$ <span class="built_in">cd</span> fusesoc &amp;&amp; pip install -e .</span><br><span class="line"></span><br><span class="line">OR</span><br><span class="line">~$ pip install fusesoc</span><br></pre></td></tr></table></figure>
<h2 id="安装fusesoc-库"><a href="#安装fusesoc-库" class="headerlink" title="安装fusesoc 库"></a>安装fusesoc 库</h2><ul>
<li>从网络安装.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ fusesoc library add intgen https://github.com/openrisc/intgen.git</span><br></pre></td></tr></table></figure>
<ul>
<li>从本地安装</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~$ git <span class="built_in">clone</span> https://github.com/openrisc/mor1kx-generic.git</span><br><span class="line">~$ git <span class="built_in">clone</span> https://github.com/openrisc/or1k_marocchino.git</span><br><span class="line"></span><br><span class="line">~$ fusesoc library add mor1kx-generic `<span class="built_in">pwd</span>`/mor1kx-generic</span><br><span class="line">~$ fusesoc library add or1k_marocchino `<span class="built_in">pwd</span>`/or1k_marocchino</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">~$ fusesoc list-cores</span><br><span class="line">Available cores:</span><br><span class="line"></span><br><span class="line">Core                      Cache status  Description</span><br><span class="line">================================================================================</span><br><span class="line">::blinky:0               :      <span class="built_in">local</span> : &lt;No description&gt;</span><br><span class="line">::intgen:0               :      <span class="built_in">local</span> : Interrupt Generator For testing Processors</span><br><span class="line">::mor1kx-generic:1.1     :      <span class="built_in">local</span> : Minimal mor1kx simulation environment</span><br><span class="line">::or1k_marocchino:5.0-r3 :      <span class="built_in">local</span> : &lt;No description&gt;</span><br><span class="line">::plights:0              :      <span class="built_in">local</span> : &lt;No description&gt;</span><br><span class="line">::rv_sopc:0              :      <span class="built_in">local</span> : RISC V system on programmable chip example</span><br><span class="line">::wb_intercon_gen_ng:0   :      <span class="built_in">local</span> : CAPI=2 .core file description based Wishbone Interconnect generator</span><br></pre></td></tr></table></figure>
<ul>
<li>查看<code>fusesoc.conf</code>配置.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">~$ cat fusesoc.conf</span><br><span class="line">[library.mor1kx-generic]</span><br><span class="line">location = /fullpath/FPGA-DE0-Nano/openrisc/mor1kx-generic</span><br><span class="line">sync-uri = /fullpath/FPGA-DE0-Nano/openrisc/mor1kx-generic</span><br><span class="line">sync-type = <span class="built_in">local</span></span><br><span class="line">auto-sync = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[library.or1k_marocchino]</span><br><span class="line">location = /fullpath/FPGA-DE0-Nano/openrisc/or1k_marocchino</span><br><span class="line">sync-uri = /fullpath/FPGA-DE0-Nano/openrisc/or1k_marocchino</span><br><span class="line">sync-type = <span class="built_in">local</span></span><br><span class="line">auto-sync = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[library.intgen]</span><br><span class="line">location = /fullpath/FPGA-DE0-Nano/openrisc/intgen</span><br><span class="line">sync-uri = /fullpath/FPGA-DE0-Nano/openrisc/intgen</span><br><span class="line">sync-type = <span class="built_in">local</span></span><br><span class="line">auto-sync = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[library.fusesoc-demos]</span><br><span class="line">location = fusesoc_libraries/fusesoc-demos</span><br><span class="line">sync-uri = https://github.com/Oxore/fusesoc-demos</span><br><span class="line">sync-type = git</span><br><span class="line">auto-sync = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h2 id="Fusesoc-demos"><a href="#Fusesoc-demos" class="headerlink" title="Fusesoc-demos"></a>Fusesoc-demos</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fusesoc library add  https://github.com/Oxore/fusesoc-demos</span><br></pre></td></tr></table></figure>
<h1 id="RISC-V"><a href="#RISC-V" class="headerlink" title="RISC-V"></a>RISC-V</h1><ul>
<li>links:<ul>
<li><a href="https://github.com/litex-hub/linux-on-litex-vexriscv" target="_blank" rel="noopener">linux-on-litex-vexriscv</a></li>
<li><a href="https://github.com/SpinalHDL/VexRiscv" target="_blank" rel="noopener">VexRiscv</a></li>
</ul>
</li>
</ul>
<h2 id="安装Quartus20"><a href="#安装Quartus20" class="headerlink" title="安装Quartus20"></a>安装<code>Quartus20</code></h2><ul>
<li>这里只是安装<a href="https://fpgasoftware.intel.com/20.1.1/?edition=lite&amp;platform=linux" target="_blank" rel="noopener">QuartusLiteSetup-20.1.1.720-linux.run</a>再加两个设备文件,没下载整个安装<code>tar</code>包,总包体积在<code>6.5GB</code>左右.<br><img src="/imgs/quartus-20.1-installation.png" alt="quartus-20.1-installation.png"></li>
</ul>
<h2 id="litex-boards测试编译"><a href="#litex-boards测试编译" class="headerlink" title="litex-boards测试编译"></a>litex-boards测试编译</h2><ul>
<li>这里使用<code>litex-hub</code>里的项目测试,<code>Quartus</code>安装到<code>~/intelFPGA_lite/20.1/quartus</code>目录下.注意,加上<code>--load</code>参数项,必须先运行<code>jtagd</code>服务,否则<code>quartus_pgm</code>无法进行<code>jtag</code>烧写.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~$ <span class="built_in">export</span> PATH=~/riscv64-toolchain/bin:~/intelFPGA_lite/20.1/quartus/bin:<span class="variable">$PATH</span></span><br><span class="line">~$ jtagd --foreground --debug</span><br><span class="line">~$ <span class="built_in">cd</span> litex-boards/litex_boards</span><br><span class="line">~$ targets/terasic_de0nano.py --uart-name=jtag_uart --build --load</span><br></pre></td></tr></table></figure>
<ul>
<li>其实最终的编译脚本是如下内容.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">linux-on-litex-vexriscv$ cat build/de0nano/gateware/build_de0nano.sh</span><br><span class="line"><span class="comment"># Autogenerated by LiteX / git: 55a79030</span></span><br><span class="line">quartus_map --read_settings_files=on  --write_settings_files=off de0nano -c de0nano</span><br><span class="line">quartus_fit --read_settings_files=off --write_settings_files=off de0nano -c de0nano</span><br><span class="line">quartus_asm --read_settings_files=off --write_settings_files=off de0nano -c de0nano</span><br><span class="line">quartus_sta de0nano -c de0nano</span><br><span class="line"><span class="keyword">if</span> [ -f <span class="string">"de0nano.sof"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    quartus_cpf -c de0nano.sof de0nano.rbf</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h2 id="linux-on-litex-vexriscv编译测试"><a href="#linux-on-litex-vexriscv编译测试" class="headerlink" title="linux-on-litex-vexriscv编译测试"></a>linux-on-litex-vexriscv编译测试</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~$ <span class="built_in">cd</span> linux-on-litex-vexriscv</span><br><span class="line">~$ <span class="built_in">export</span> PATH=~/riscv64-toolchain/bin:~/intelFPGA_lite/20.1/quartus/bin:<span class="variable">$PATH</span></span><br><span class="line">~$ ./make.py --board=de0nano --build --load</span><br></pre></td></tr></table></figure>
<ul>
<li>运行<code>--load</code>参数时,需要确保<code>jtagd</code>是运行的,这里如下面所示,最终是使用<code>quartus_pgm -m jtag -c USB-Blaster</code>加载的.<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[...]</span><br><span class="line">Info: Command: quartus_pgm -m jtag -c USB-Blaster -o p;/home/michael/workspace-xilinx/RISC-V/litex-hub/litex/linux-on-litex-vexriscv/build/de0nano/gateware/de0nano.sof@1</span><br><span class="line">Info (213046): Using programming cable <span class="string">"USB-Blaster on 127.0.0.1 [3-3]"</span></span><br><span class="line">Info (213011): Using programming file /home/michael/workspace-xilinx/RISC-V/litex-hub/litex/linux-on-litex-vexriscv/build/de0nano/gateware/de0nano.sof with checksum 0x0085AEAF <span class="keyword">for</span> device EP4CE22F17@1</span><br><span class="line">Info (209060): Started Programmer operation at Sat Feb 26 11:35:48 2022</span><br><span class="line">Info (209016): Configuring device index 1</span><br><span class="line">Info (209017): Device 1 contains JTAG ID code 0x020F30DD</span><br><span class="line">Info (209007): Configuration succeeded -- 1 device(s) configured</span><br><span class="line">Info (209011): Successfully performed operation(s)</span><br><span class="line">Info (209061): Ended Programmer operation at Sat Feb 26 11:35:49 2022</span><br><span class="line">Info: Quartus Prime Programmer was successful. 0 errors, 0 warnings</span><br><span class="line">    Info: Peak virtual memory: 315 megabytes</span><br><span class="line">    Info: Processing ended: Sat Feb 26 11:35:49 2022</span><br><span class="line">    Info: Elapsed time: 00:00:32</span><br><span class="line">    Info: Total CPU time (on all processors): 00:00:00</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="通过JTAG-UART查看启动信息"><a href="#通过JTAG-UART查看启动信息" class="headerlink" title="通过JTAG-UART查看启动信息"></a>通过<code>JTAG-UART</code>查看启动信息</h3><ul>
<li>这里脚本默认是选择<code>serial</code>进行通信的,上面我在编译时选择了<code>--uart-name=jtag_uart</code>,想测试使用板的上<code>USB JTAG</code>的方式来进行<code>uart</code>通信.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">~$ ./targets/terasic_de0nano.py --<span class="built_in">help</span></span><br><span class="line"> [...]</span><br><span class="line"> --no-uart</span><br><span class="line">          Disable UART. (default: False)</span><br><span class="line">  --uart-name UART_NAME</span><br><span class="line">          UART <span class="built_in">type</span>/name. (default: serial)</span><br><span class="line">  --uart-baudrate UART_BAUDRATE</span><br><span class="line">          UART baudrate. (default: 115200)</span><br><span class="line">  --uart-fifo-depth UART_FIFO_DEPTH</span><br><span class="line">          UART FIFO depth. (default: 16)</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
<ul>
<li>新建一个<code>openocd</code>的配置文件,针对<code>de0nano EP4CE22F17</code>的参数设置,如下:</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">litex_boards$ cat prog/openocd_de0nano.cfg</span><br><span class="line">adapter driver usb_blaster</span><br><span class="line">usb_blaster lowlevel_driver ftdi</span><br><span class="line"><span class="built_in">set</span> _CHIPNAME EP4CE22F17</span><br><span class="line"><span class="built_in">set</span> FPGA_TAPID 0x020F30DD</span><br><span class="line">adapter speed 6000</span><br><span class="line">jtag newtap <span class="variable">$_CHIPNAME</span> tap -irlen 10 -expected-id <span class="variable">$FPGA_TAPID</span></span><br><span class="line"><span class="comment">#scan_chain</span></span><br><span class="line">gdb_port disabled</span><br><span class="line">tcl_port disabled</span><br></pre></td></tr></table></figure>
<ul>
<li>连接如下</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> ~/.<span class="built_in">local</span>/bin/litex_term jtag --jtag-config=./prog/openocd_de0nano.cfg</span><br><span class="line">port is 20000</span><br><span class="line">got ir value 2</span><br><span class="line">Open On-Chip Debugger 0.11.0+dev-00562-g5ab74bde0-dirty (2022-02-07-19:44)</span><br><span class="line">Licensed under GNU GPL v2</span><br><span class="line">For bug reports, <span class="built_in">read</span></span><br><span class="line">	http://openocd.org/doc/doxygen/bugs.html</span><br><span class="line">Info : only one transport option; autoselect <span class="string">'jtag'</span></span><br><span class="line">jtagstream_serve</span><br><span class="line">Info : usb blaster interface using libftdi</span><br><span class="line">Info : This adapter doesn<span class="string">'t support configurable speed</span></span><br><span class="line"><span class="string">Info : JTAG tap: EP4CE22F17.tap tap/device found: 0x020f30dd (mfg: 0x06e (Altera), part: 0x20f3, ver: 0x0)</span></span><br><span class="line"><span class="string">Warn : gdb services need one or more targets defined</span></span><br></pre></td></tr></table></figure>
<ul>
<li>连接到<code>jtag-uart</code>就直接挂住了,没有出来串口终端, 而通过<code>litex_term</code>连接<code>jtag</code>的参数是包装了<code>openocd</code>的命令行,等价与如下命令：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ openocd -f ./prog/openocd_de0nano.cfg -f stream.cfg -c &lt;....&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>因为<code>--build</code>完成后会在当前目录下生成<code>stream.cfg</code>文件,它就是用<code>TCL</code>脚本定义的<code>openocd</code>的配置文件,它的自动生成来源是位于:<code>litex/litex/build/openocd.py</code>里, 片段如下：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">litex$ tail -n 20 litex/litex/build/openocd.py</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">proc jtagstream_serve &#123;tap port&#125; &#123;</span><br><span class="line">    <span class="built_in">set</span> sock [socket stream.server <span class="variable">$port</span>]</span><br><span class="line">    <span class="variable">$sock</span> readable [list jtagstream_client <span class="variable">$tap</span> <span class="variable">$sock</span>]</span><br><span class="line">    stdin readable [list jtagstream_exit <span class="variable">$sock</span>]</span><br><span class="line">    vwait forever</span><br><span class="line">    <span class="variable">$sock</span> close</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">""</span><span class="string">"</span></span><br><span class="line"><span class="string">        write_to_file("</span>stream.cfg<span class="string">", cfg)</span></span><br><span class="line"><span class="string">        print("</span>port is &#123;:d&#125;<span class="string">".format(port))</span></span><br><span class="line"><span class="string">        print("</span>got ir value &#123;:d&#125;<span class="string">".format(self.get_ir(chain,config)))</span></span><br><span class="line"><span class="string">        script = "</span>; <span class="string">".join([</span></span><br><span class="line"><span class="string">            "</span>init<span class="string">",</span></span><br><span class="line"><span class="string">            "</span>irscan <span class="variable">$_CHIPNAME</span>.tap &#123;:d&#125;<span class="string">".format(self.get_ir(chain, config)),</span></span><br><span class="line"><span class="string">            "</span>jtagstream_serve <span class="variable">$_CHIPNAME</span>.tap &#123;:d&#125;<span class="string">".format(port),</span></span><br><span class="line"><span class="string">            "</span><span class="built_in">exit</span><span class="string">",</span></span><br><span class="line"><span class="string">        ])</span></span><br><span class="line"><span class="string">        self.call(["</span>openocd<span class="string">", "</span>-f<span class="string">", config, "</span>-f<span class="string">", "</span>stream.cfg<span class="string">", "</span>-c<span class="string">", script])</span></span><br></pre></td></tr></table></figure>
<ul>
<li>想通过板上的<code>USB</code>接口,连接<code>jtag_uart</code>的方式不成功.</li>
</ul>
<h3 id="通过串口查看系统启动信息"><a href="#通过串口查看系统启动信息" class="headerlink" title="通过串口查看系统启动信息"></a>通过串口查看系统启动信息</h3><ul>
<li>因为使用<code>jtag_uart</code>方式连接串口不成功,还是选择默认的<code>serial</code>方式连接,因为板上没有<code>USB to UART</code>的功能,看相关文档也没说明如何连接到板上的<code>uart</code>,通过搜索源码发现如下的定义:</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">litex-boards$ cat litex_boards/platforms/terasic_de0nano.py</span><br><span class="line">[...]</span><br><span class="line"> <span class="comment"># Switches</span></span><br><span class="line">    (<span class="string">"sw"</span>, 0, Pins(<span class="string">"M1"</span>),  IOStandard(<span class="string">"3.3-V LVTTL"</span>)),</span><br><span class="line">    (<span class="string">"sw"</span>, 1, Pins(<span class="string">"T8"</span>),  IOStandard(<span class="string">"3.3-V LVTTL"</span>)),</span><br><span class="line">    (<span class="string">"sw"</span>, 2, Pins(<span class="string">"B9"</span>),  IOStandard(<span class="string">"3.3-V LVTTL"</span>)),</span><br><span class="line">    (<span class="string">"sw"</span>, 3, Pins(<span class="string">"M15"</span>), IOStandard(<span class="string">"3.3-V LVTTL"</span>)),</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Serial</span></span><br><span class="line">    (<span class="string">"serial"</span>, 0,</span><br><span class="line">        <span class="comment"># Compatible with cheap FT232 based cables (ex: Gaoominy 6Pin Ftdi Ft232Rl Ft232)</span></span><br><span class="line">        <span class="comment"># GND on JP1 Pin 12.</span></span><br><span class="line">        Subsignal(<span class="string">"tx"</span>, Pins(<span class="string">"JP1:10"</span>), IOStandard(<span class="string">"3.3-V LVTTL"</span>)),</span><br><span class="line">        Subsignal(<span class="string">"rx"</span>, Pins(<span class="string">"JP1:8"</span>),  IOStandard(<span class="string">"3.3-V LVTTL"</span>))</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    <span class="comment"># SDR SDRAM</span></span><br><span class="line">    (<span class="string">"sdram_clock"</span>, 0, Pins(<span class="string">"R4"</span>), IOStandard(<span class="string">"3.3-V LVTTL"</span>)),</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
<ul>
<li>这里使用<code>FTDI 2232H</code>连接如下：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DE0-nano JP1                FT2232H</span><br><span class="line">GPIO_05 Pin8     &lt;-------&gt;  AD0 TXD</span><br><span class="line">GPIO_07 Pin10    &lt;-------&gt;  AD1 RXD</span><br><span class="line">GND     Pin12    &lt;-------&gt;  GND</span><br></pre></td></tr></table></figure>
<ul>
<li>到这里就可以使用<code>litex_term</code>或者<code>minicom</code>来连接板上串口了,如果出现乱码,就是<code>UART baudrate</code>问题,这里是默认其实是<code>1Mbps(1e6)</code>,而且发现在某宝买的很多<code>USB to UART</code>在连接<code>1Mbps</code>还是会出现乱码,不能输入等问题,我换成<code>FTDI 2232H</code>就可以正常使用了.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">litex-boards $ minicom -o -b 1000000 -D /dev/ttyUSB0</span><br><span class="line"></span><br><span class="line">        __   _ __      _  __</span><br><span class="line">       / /  (_) /____ | |/_/</span><br><span class="line">      / /__/ / __/ -_)&gt;  &lt;</span><br><span class="line">     /____/_/\__/\__/_/|_|</span><br><span class="line">   Build your hardware, easily!</span><br><span class="line"></span><br><span class="line"> (c) Copyright 2012-2022 Enjoy-Digital</span><br><span class="line"> (c) Copyright 2007-2015 M-Labs</span><br><span class="line"></span><br><span class="line"> BIOS CRC passed (1f65f3e6)</span><br><span class="line"></span><br><span class="line"> Migen git sha1: ac70301</span><br><span class="line"> LiteX git sha1: 7cc781f7</span><br><span class="line"></span><br><span class="line">--=============== SoC ==================--</span><br><span class="line">CPU:            VexRiscv SMP-LINUX @ 50MHz</span><br><span class="line">BUS:            WISHBONE 32-bit @ 4GiB</span><br><span class="line">CSR:            32-bit data</span><br><span class="line">ROM:            64KiB</span><br><span class="line">SRAM:           8KiB</span><br><span class="line">L2:             2KiB</span><br><span class="line">SDRAM:          32768KiB 16-bit @ 50MT/s (CL-2 CWL-2)</span><br><span class="line"></span><br><span class="line">--========== Initialization ============--</span><br><span class="line">Initializing SDRAM @0x40000000...</span><br><span class="line">Switching SDRAM to software control.</span><br><span class="line">Switching SDRAM to hardware control.</span><br><span class="line">Memtest at 0x40000000 (2.0MiB)...</span><br><span class="line">  Write: 0x40000000-0x40200000 2.0MiB</span><br><span class="line">   Read: 0x40000000-0x40200000 2.0MiB</span><br><span class="line">Memtest OK</span><br><span class="line">Memspeed at 0x40000000 (Sequential, 2.0MiB)...</span><br><span class="line">  Write speed: 15.8MiB/s</span><br><span class="line">   Read speed: 11.7MiB/s</span><br><span class="line"></span><br><span class="line">--============== Boot ==================--</span><br><span class="line">Booting from serial...</span><br><span class="line">Press Q or ESC to abort boot completely.</span><br><span class="line">sL5DdSMmkekro</span><br><span class="line">             Timeout</span><br><span class="line">No boot medium found</span><br><span class="line"></span><br><span class="line">--============= Console ================--</span><br><span class="line"></span><br><span class="line">litex&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>可以通过<code>help</code>查看可以支持的命令</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">litex&gt; <span class="built_in">help</span></span><br><span class="line">LiteX BIOS, available commands:</span><br><span class="line"></span><br><span class="line"><span class="built_in">help</span>                     - Print this <span class="built_in">help</span></span><br><span class="line">ident                    - Identifier of the system</span><br><span class="line">crc                      - Compute CRC32 of a part of the address space</span><br><span class="line">flush_cpu_dcache         - Flush CPU data cache</span><br><span class="line">flush_l2_cache           - Flush L2 cache</span><br><span class="line">leds                     - Set Leds value</span><br><span class="line"></span><br><span class="line">boot                     - Boot from Memory</span><br><span class="line">reboot                   - Reboot</span><br><span class="line">serialboot               - Boot from Serial (SFL)</span><br><span class="line"></span><br><span class="line">mem_list                 - List available memory regions</span><br><span class="line">mem_read                 - Read address space</span><br><span class="line">mem_write                - Write address space</span><br><span class="line">mem_copy                 - Copy address space</span><br><span class="line">mem_test                 - Test memory access</span><br><span class="line">mem_speed                - Test memory speed</span><br><span class="line">mem_cmp                  - Compare memory content</span><br><span class="line"></span><br><span class="line">sdram_test               - Test SDRAM</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">litex&gt; ident</span><br><span class="line"></span><br><span class="line">Ident: LiteX SoC on DE0-Nano</span><br></pre></td></tr></table></figure>
<ul>
<li><code>leds</code>命令可以控制板上的<code>led0~led7</code>的开关,</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">litex&gt; leds 255  <span class="comment"># 全部亮灯</span></span><br><span class="line"></span><br><span class="line">Settings Leds to 0xff</span><br><span class="line">litex&gt; leds 1    <span class="comment"># led0 亮</span></span><br><span class="line"></span><br><span class="line">Settings Leds to 0x1</span><br><span class="line"></span><br><span class="line">litex&gt;  leds 11  <span class="comment"># led0,led1,led3亮, (1 &lt;&lt; 0) + (1 &lt;&lt; 1) + (1 &lt;&lt; 3)</span></span><br><span class="line"></span><br><span class="line">Settings Leds to 0xb</span><br></pre></td></tr></table></figure>
<h3 id="添加SPI-SDCard外设"><a href="#添加SPI-SDCard外设" class="headerlink" title="添加SPI-SDCard外设"></a>添加<code>SPI-SDCard</code>外设</h3><ul>
<li><code>de0-nano</code>板子上没有接<code>sdcard</code>的插槽,这里给它在<code>JP1 Headers</code>上连接一个<code>SPI-SDCard</code>插槽,并且让它能从<code>SDCard boot</code>方式,加载<code>Linux</code>.所以需修改相应的源码,先是在<code>linux-on-litex-vexriscv/make.py</code>里的<code>De0Nano</code>类下面的参数<code>soc_capabilities</code>添加<code>spisdcard</code>,如下：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">litex-hub/linux-on-litex-vexriscv$ cat make.py</span><br><span class="line">[...]</span><br><span class="line">class De0Nano(Board):</span><br><span class="line">    soc_kwargs = &#123;<span class="string">"l2_size"</span> : 2048&#125; <span class="comment"># Use Wishbone and L2 for memory accesses.</span></span><br><span class="line">    def __init__(self):</span><br><span class="line">        from litex_boards.targets import de0nano</span><br><span class="line">        Board.__init__(self, de0nano.BaseSoC, soc_capabilities=&#123;</span><br><span class="line">            <span class="comment"># Communication</span></span><br><span class="line">            <span class="string">"serial"</span>,</span><br><span class="line">            <span class="string">"spisdcard"</span></span><br><span class="line">        &#125;, bitstream_ext=<span class="string">".sof"</span>)</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
<ul>
<li>再去到<code>litex-hub/litex-boards</code>的项目下,添加如下补丁修改</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">litex-hub/litex-boards$ git diff litex_boards/platforms/terasic_de0nano.py</span><br><span class="line">diff --git a/litex_boards/platforms/terasic_de0nano.py b/litex_boards/platforms/terasic_de0nano.py</span><br><span class="line">index 3284ddc..7a810f7 100644</span><br><span class="line">--- a/litex_boards/platforms/terasic_de0nano.py</span><br><span class="line">+++ b/litex_boards/platforms/terasic_de0nano.py</span><br><span class="line">@@ -115,6 +115,14 @@ _io = [</span><br><span class="line">         <span class="string">"F15 F16 F14 G16 G15"</span>),</span><br><span class="line">         IOStandard(<span class="string">"3.3-V LVTTL"</span>)</span><br><span class="line">     ),</span><br><span class="line">+    <span class="comment"># SDCard</span></span><br><span class="line">+    (<span class="string">"spisdcard"</span>, 0,</span><br><span class="line">+        Subsignal(<span class="string">"clk"</span>,  Pins(<span class="string">"JP1:18"</span>)),</span><br><span class="line">+        Subsignal(<span class="string">"cs_n"</span>, Pins(<span class="string">"JP1:20"</span>)),</span><br><span class="line">+        Subsignal(<span class="string">"mosi"</span>, Pins(<span class="string">"JP1:14"</span>), Misc(<span class="string">"WEAK_PULL_UP_RESISTOR ON"</span>)),</span><br><span class="line">+        Subsignal(<span class="string">"miso"</span>, Pins(<span class="string">"JP1:16"</span>), Misc(<span class="string">"WEAK_PULL_UP_RESISTOR ON"</span>)),</span><br><span class="line">+        IOStandard(<span class="string">"3.3-V LVTTL"</span>)</span><br><span class="line">+    ),</span><br><span class="line"> ]</span><br><span class="line"></span><br><span class="line"> <span class="comment"># Connectors ---------------------------------------------------------------------------------------</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>编译<code>linux-on-litex-vexriscv</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linux-on-litex-vexriscv$ ./make.py --board=de0nano --build</span><br></pre></td></tr></table></figure>
</li>
<li><p>完成后,先把一张<code>SD卡</code>格式成用<code>fdisk</code>修改分区类型为<code>W95 FAT32</code>,再用<code>mkfs.fat</code>格化它.再把<code>linux-on-litex-vexriscv/images</code>里面的文件复到<code>SD卡</code>的根目录里.<code>SPI-SDCard</code>模块与<code>JP1</code>接线如下：</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SPI-Card Module              de0-nano JP1  FPGA Pin No</span><br><span class="line">    CS         &lt;----------&gt;    JP1:20      GPIO_015 C6</span><br><span class="line">    CLK        &lt;----------&gt;    JP1:18      GPIO_013 D6</span><br><span class="line">    SDO        &lt;----------&gt;    JP1:16      GPIO_011 A6</span><br><span class="line">    SDI        &lt;----------&gt;    JP1:14      GPIO_09  D5</span><br><span class="line">    GND        &lt;----------&gt;    GND</span><br><span class="line">    3V3        &lt;----------&gt;    3V3</span><br></pre></td></tr></table></figure>
<ul>
<li>上面的接线可以参考<code>litex_boards/platforms/terasic_de0nano.py</code>里的代码与上面介绍里<code>GPIO-0 Pin Assignments</code>的描述去理解与开发.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linux-on-litex-vexriscv$ ./make.py --board=de0nano --load</span><br></pre></td></tr></table></figure>
<ul>
<li><p>串口连接,并从<code>SDCard booting</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">linux-on-litex-vexriscv$ minicom -o -b 1000000 -D /dev/ttyUSB0</span><br><span class="line"></span><br><span class="line">(c) Copyright 2012-2022 Enjoy-Digital</span><br><span class="line"> (c) Copyright 2007-2015 M-Labs</span><br><span class="line"></span><br><span class="line"> BIOS CRC passed (1038d38c)</span><br><span class="line"></span><br><span class="line"> Migen git sha1: ac70301</span><br><span class="line"> LiteX git sha1: 7f49c523</span><br><span class="line"></span><br><span class="line">--=============== SoC ==================--</span><br><span class="line">CPU:            VexRiscv SMP-LINUX @ 50MHz</span><br><span class="line">BUS:            WISHBONE 32-bit @ 4GiB</span><br><span class="line">CSR:            32-bit data</span><br><span class="line">ROM:            64KiB</span><br><span class="line">SRAM:           8KiB</span><br><span class="line">L2:             2KiB</span><br><span class="line">SDRAM:          32768KiB 16-bit @ 50MT/s (CL-2 CWL-2)</span><br><span class="line"></span><br><span class="line">--========== Initialization ============--</span><br><span class="line">Initializing SDRAM @0x40000000...</span><br><span class="line">Switching SDRAM to software control.</span><br><span class="line">Switching SDRAM to hardware control.</span><br><span class="line">Memtest at 0x40000000 (2.0MiB)...</span><br><span class="line">  Write: 0x40000000-0x40200000 2.0MiB</span><br><span class="line">   Read: 0x40000000-0x40200000 2.0MiB</span><br><span class="line">Memtest OK</span><br><span class="line">Memspeed at 0x40000000 (Sequential, 2.0MiB)...</span><br><span class="line">  Write speed: 16.7MiB/s</span><br><span class="line">   Read speed: 20.3MiB/s</span><br><span class="line"></span><br><span class="line">--============== Boot ==================--</span><br><span class="line">Booting from serial...</span><br><span class="line">Press Q or ESC to abort boot completely.</span><br><span class="line">sL5DdSMmkekro</span><br><span class="line">             Timeout</span><br><span class="line">Booting from SDCard <span class="keyword">in</span> SPI-Mode...</span><br><span class="line">Booting from boot.json...</span><br><span class="line">Copying Image to 0x40000000 (7531468 bytes)...</span><br><span class="line">[<span class="comment">########################################]</span></span><br><span class="line">Copying rv32.dtb to 0x40ef0000 (2621 bytes)...</span><br><span class="line">[<span class="comment">########################################]</span></span><br><span class="line">Copying rootfs.cpio to 0x41000000 (3786240 bytes)...</span><br><span class="line">[<span class="comment">########################################]</span></span><br><span class="line">Copying opensbi.bin to 0x40f00000 (53640 bytes)...</span><br><span class="line">[<span class="comment">########################################]</span></span><br><span class="line">Executing booted program at 0x40f00000</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果从<code>SDCard</code>启动失败,先确保卡的分区格式是<code>W95 FAT32</code>,再换一张卡测试一下,因为我这边使用一张<code>512MB</code>的旧卡,另一张是<code>1GB</code>的旧卡,都无法检测到,换了一张<code>32GB,128GB</code>卡,都能成功加载运行.好像<code>enjoy-digital/litesdcard</code>对旧卡兼容有问题,或者是其它未知的原因.</p>
</li>
</ul>
<h3 id="quartus-cpf命令"><a href="#quartus-cpf命令" class="headerlink" title="quartus_cpf命令"></a>quartus_cpf命令</h3><ul>
<li>查看参数帮助说明,如：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">~$ quartus_cpf --<span class="built_in">help</span>=rpd</span><br><span class="line"></span><br><span class="line">Topic: rpd</span><br><span class="line"></span><br><span class="line">To generate a Raw Programming Data File (.rpd), specify the input</span><br><span class="line">file name and output file name. Make sure the file extension</span><br><span class="line">of the output file is .rpd. The input file can be only a</span><br><span class="line">Programmer Object File (.pof).</span><br><span class="line"></span><br><span class="line">---------</span><br><span class="line">Examples:</span><br><span class="line">---------</span><br><span class="line"></span><br><span class="line"><span class="comment"># To convert .pof to .rpd</span></span><br><span class="line">quartus_cpf -c &lt;input_pof_file&gt; &lt;output_rpd_file&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># To use a Conversion Setup File (.cof) created with</span></span><br><span class="line"><span class="comment"># the Convert Programming Files dialog box in the UI</span></span><br><span class="line">quartus_cpf -c &lt;input_cof_file&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>查看<code>sof</code>文件的信息</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">~$ quartus_cpf --info de0nano.sof</span><br><span class="line">                File: de0nano.sof</span><br><span class="line">            File CRC: 0x24F3</span><br><span class="line">             Creator: Quartus Prime Compiler Version 20.1.1 Build 720 11/11/2020 SJ Lite Edition</span><br><span class="line">             Comment: Untitled</span><br><span class="line">              Device: EP4CE22F17</span><br><span class="line">       Data checksum: 0x008595BA</span><br><span class="line">       JTAG usercode: 0x008595BA</span><br><span class="line">        Project Hash: 0x</span><br></pre></td></tr></table></figure>
<ul>
<li>生成<code>svf</code>文件</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ quartus_cpf -c -q 6.0MHz -g 3.3 -n p de0nano.sof de0nano.svf</span><br></pre></td></tr></table></figure>
<ul>
<li>生成<code>rpd</code>文件</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~$ quartus_cpf -c -d EPCS64 de0nano.sof de0nano.pof</span><br><span class="line">~$ quartus_cpf -c -d EPCS64 -s EP4CE22F17 de0nano.pof de0nano.rpd</span><br></pre></td></tr></table></figure>
<ul>
<li>生成<code>jic</code>文件,可以使用<code>Quartus Prime IDE -&gt; Tools -&gt; Programmer -&gt; Add File...</code>进行烧写,需确保<code>jtagd</code>服务是运行的.<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ quartus_cpf -c -d EPCS64 -s EP4CE22F17 de0nano.sof de0nano.jic</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="用openocd加载svf文件"><a href="#用openocd加载svf文件" class="headerlink" title="用openocd加载svf文件."></a>用<code>openocd</code>加载<code>svf</code>文件.</h2><ul>
<li><p>根据板子参数，创建一个<code>openocd</code>的连接配置文件.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">~$ cat &gt; openocd_de0nano.cfg &lt;&lt;EOF</span><br><span class="line">adapter driver usb_blaster</span><br><span class="line">usb_blaster lowlevel_driver ftdi</span><br><span class="line"><span class="built_in">set</span> CHIPNAME EP4CE22F17</span><br><span class="line"><span class="built_in">set</span> FPGA_TAPID 0x020F30DD <span class="comment"># 通过jtagconfig取得</span></span><br><span class="line">adapter speed 6000</span><br><span class="line">jtag newtap <span class="variable">$CHIPNAME</span> tap -irlen 10 -expected-id <span class="variable">$FPGA_TAPID</span></span><br><span class="line">init</span><br><span class="line">scan_chain</span><br><span class="line"></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>加载到<code>FPGA</code>.</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">~$ openocd -f ./openocd_de0nano.cfg -c &quot;svf  de0nano.svf progress&quot; -c exit</span><br><span class="line">Open On-Chip Debugger 0.11.0+dev-00562-g5ab74bde0-dirty (2022-02-07-19:44)</span><br><span class="line">Licensed under GNU GPL v2</span><br><span class="line">For bug reports, read</span><br><span class="line">	http://openocd.org/doc/doxygen/bugs.html</span><br><span class="line">Info : only one transport option; autoselect &apos;jtag&apos;</span><br><span class="line">Info : usb blaster interface using libftdi</span><br><span class="line">Info : This adapter doesn&apos;t support configurable speed</span><br><span class="line">Info : JTAG tap: EP4CE22F17.tap tap/device found: 0x020f30dd (mfg: 0x06e (Altera), part: 0x20f3, ver: 0x0)</span><br><span class="line">Warn : gdb services need one or more targets defined</span><br><span class="line">   TapName             Enabled  IdCode     Expected   IrLen IrCap IrMask</span><br><span class="line">-- ------------------- -------- ---------- ---------- ----- ----- ------</span><br><span class="line"> 0 EP4CE22F17.tap         Y     0x020f30dd 0x020f30dd    10 0x01  0x03</span><br><span class="line"></span><br><span class="line">svf processing file: &quot;de0nano.svf&quot;</span><br><span class="line">  0%  FREQUENCY 1.20E+07 HZ;</span><br><span class="line">Error: Translation from khz to adapter speed not implemented</span><br><span class="line"></span><br><span class="line">  0%  TRST ABSENT;</span><br><span class="line">  0%  ENDDR IDLE;</span><br><span class="line">  0%  ENDIR IRPAUSE;</span><br><span class="line">  0%  STATE IDLE;</span><br><span class="line">  0%  SIR 10 TDI (002);</span><br><span class="line">  0%  RUNTEST IDLE 12000 TCK ENDSTATE IDLE;</span><br><span class="line"> 95%  	FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF);</span><br><span class="line"> 95%  SIR 10 TDI (004);</span><br><span class="line"> 95%  RUNTEST 60 TCK;</span><br><span class="line"> 95%  	000000000000000000000000000000000000000000000000000000000000000000);</span><br><span class="line"> 95%  SIR 10 TDI (003);</span><br><span class="line"> 95%  RUNTEST 49152 TCK;</span><br><span class="line"> 95%  RUNTEST 512 TCK;</span><br><span class="line"> 95%  SIR 10 TDI (3FF);</span><br><span class="line"> 95%  RUNTEST 12000 TCK;</span><br><span class="line"> 95%  STATE IDLE;</span><br><span class="line"></span><br><span class="line">Time used: 0m1s439ms</span><br><span class="line">svf file programmed successfully for 17 commands with 0 errors</span><br></pre></td></tr></table></figure>
<h2 id="烧写到SPI-FLASH"><a href="#烧写到SPI-FLASH" class="headerlink" title="烧写到SPI FLASH"></a>烧写到<code>SPI FLASH</code></h2><ul>
<li><a href="https://trabucayre.github.io/openFPGALoader/vendors/intel.html" target="_blank" rel="noopener">openFPGALoader Intel/Altera</a></li>
<li>这里使用<code>openFPGALoader -b de0nano -f de0nano.rpd</code>显示烧写错误:<code>flash stackflow</code>,后面使用下面的命令就可以正常烧写到<code>Flash</code>.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ openFPGALoader -c usb-blaster --fpga-part ep4ce2217 -f  de0nano.rbf</span><br></pre></td></tr></table></figure>
<h2 id="UrJtag使用"><a href="#UrJtag使用" class="headerlink" title="UrJtag使用"></a>UrJtag使用</h2><ul>
<li>直接使用<code>apt-get install urjtag</code>的版本较老,是不支持<code>ep4c22</code>,显示如下：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">~$ jtag</span><br><span class="line">jtag&gt; cable UsbBlaster vid=0x09fb pid=0x6001 interface=0</span><br><span class="line">Connected to libftdi driver.</span><br><span class="line">jtag&gt; detect</span><br><span class="line">IR length: 10</span><br><span class="line">Chain length: 1</span><br><span class="line">Device Id: 00000010000011110011000011011101 (0x020F30DD)</span><br><span class="line">  Manufacturer: Altera (0x0DD)</span><br><span class="line">  Unknown part! (0010000011110011) (/usr/share/urjtag/altera/PARTS)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>通过参照<a href="https://intelligenttoasters.blog/2014/07/28/urjtag-and-python-a-lightweight-hal/" target="_blank" rel="noopener">这里</a>,从最新(urjtag-2021.03)源码去编译它,这里还需要去<code>FTDI</code>的官网去<a href="https://ftdichip.com/wp-content/uploads/2021/09/libftd2xx-x86_64-1.4.24.tgz" target="_blank" rel="noopener">下载D2XX Drivers</a></p>
</li>
<li><p>下载<code>D2XX Drivers</code></p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~$ wget -c https://ftdichip.com/wp-content/uploads/2021/09/libftd2xx-x86_64-1.4.24.tgz</span><br><span class="line">~$ tar xvf libftd2xx-x86_64-1.4.24.tgz</span><br><span class="line">release/</span><br><span class="line">release/release-notes.txt</span><br><span class="line">release/WinTypes.h</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
<ul>
<li>编译安装<code>urjtag-2021.03</code></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">~$ wget -c https://sourceforge.net/projects/urjtag/files/urjtag/2021.03/urjtag-2021.03.tar.xz/download</span><br><span class="line">~$ tar xvf urjtag-2021.03.tar.xz</span><br><span class="line">~$ <span class="built_in">cd</span> urjtag-2021.03</span><br><span class="line">~4 CLFAGS=-I<span class="variable">$PWD</span>/../release LDFLAGS=<span class="string">"-L<span class="variable">$PWD</span>/../release/build -lftd2xx"</span> ./configure --with-libusb  --with-libftdi  --with-ftd2xx</span><br><span class="line">[...]</span><br><span class="line">  Libraries:</span><br><span class="line">    libusb     : 1.0</span><br><span class="line">    libftdi    : yes (have async mode)</span><br><span class="line">    libftd2xx  : yes</span><br><span class="line">    inpout32   : no</span><br><span class="line"></span><br><span class="line">  Subsystems:</span><br><span class="line">    SVF        : yes</span><br><span class="line">    BSDL       : yes</span><br><span class="line">    STAPL      : no</span><br><span class="line"></span><br><span class="line">  Drivers:</span><br><span class="line">    Bus        : ahbjtag arm9tdmi au1500 avr32 bcm1250 blackfin bscoach ejtag ejtag_dma fjmem ixp425 ixp435 ixp465 jopcyc h7202 lh7a400 mpc5200 mpc824x mpc8313 mpc837x ppc405ep ppc440gx_ebc8 prototype pxa2x0 pxa27x s3c4510 sa1110 sh7727 sh7750r sh7751r sharc_21065L sharc_21369_ezkit slsup3 tx4925 zefant_xs3</span><br><span class="line">    Cable      : arcom byteblaster dirtyjtag dlc5 ea253 ei012 ft2232 gpio ice100 igloo jlink keithkoep lattice mpcbdm triton usbblaster vsllink wiggler xpc</span><br><span class="line">    Lowlevel   : direct ftdi ftd2xx ppdev</span><br><span class="line"></span><br><span class="line">  Language bindings:</span><br><span class="line">    python     : yes</span><br><span class="line">~$ make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<ul>
<li>应用<code>ep4ce22</code>描述文件的补丁</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">~$ <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/share/urjtag$</span><br><span class="line">~$ sudo patch -p1 &lt; ~/urjtag-descriptors.patch</span><br><span class="line">patching file altera/ep4ce22/ep4ce22</span><br><span class="line">patching file altera/ep4ce22/STEPPINGS</span><br><span class="line">patching file altera/PARTS</span><br><span class="line">Hunk <span class="comment">#1 succeeded at 28 (offset 2 lines).</span></span><br><span class="line">michael@debian:/usr/<span class="built_in">local</span>/share/urjtag$ /usr/<span class="built_in">local</span>/bin/jtag</span><br></pre></td></tr></table></figure>
<ul>
<li>补丁文件</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">~$ cat urjtag-descriptors.patch</span><br><span class="line">diff -Naur urjtag-orig/altera/ep4ce22/ep4ce22 urjtag/altera/ep4ce22/ep4ce22</span><br><span class="line">--- urjtag-orig/altera/ep4ce22/ep4ce22	1970-01-01 10:00:00.000000000 +1000</span><br><span class="line">+++ urjtag/altera/ep4ce22/ep4ce22	2014-07-30 21:48:09.652857260 +1000</span><br><span class="line">@@ -0,0 +1,12 @@</span><br><span class="line">+instruction length 10</span><br><span class="line">+register DIR 32</span><br><span class="line">+register USERCODE 32</span><br><span class="line">+register BSR 732</span><br><span class="line">+register BYPASS 1</span><br><span class="line">+instruction HIGHZ 0000001011 BYPASS</span><br><span class="line">+instruction CLAMP 0000001010 BYPASS</span><br><span class="line">+instruction USERCODE 0000000111 USERCODE</span><br><span class="line">+instruction IDCODE 0000000110 DIR</span><br><span class="line">+instruction SAMPLE/PRELOAD 0000000101 BSR</span><br><span class="line">+instruction EXTEST 0000001111 BSR</span><br><span class="line">+instruction BYPASS 1111111111 BYPASS</span><br><span class="line">diff -Naur urjtag-orig/altera/ep4ce22/STEPPINGS urjtag/altera/ep4ce22/STEPPINGS</span><br><span class="line">--- urjtag-orig/altera/ep4ce22/STEPPINGS	1970-01-01 10:00:00.000000000 +1000</span><br><span class="line">+++ urjtag/altera/ep4ce22/STEPPINGS	2014-07-30 21:48:09.644857260 +1000</span><br><span class="line">@@ -0,0 +1,23 @@</span><br><span class="line">+<span class="comment">#</span></span><br><span class="line">+<span class="comment"># $Id: STEPPINGS 897 2007-12-29 13:02:32Z arniml $</span></span><br><span class="line">+<span class="comment">#</span></span><br><span class="line">+<span class="comment"># This program is free software; you can redistribute it and/or</span></span><br><span class="line">+<span class="comment"># modify it under the terms of the GNU General Public License</span></span><br><span class="line">+<span class="comment"># as published by the Free Software Foundation; either version 2</span></span><br><span class="line">+<span class="comment"># of the License, or (at your option) any later version.</span></span><br><span class="line">+<span class="comment">#</span></span><br><span class="line">+<span class="comment"># This program is distributed in the hope that it will be useful,</span></span><br><span class="line">+<span class="comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span></span><br><span class="line">+<span class="comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></span><br><span class="line">+<span class="comment"># GNU General Public License for more details.</span></span><br><span class="line">+<span class="comment">#</span></span><br><span class="line">+<span class="comment"># You should have received a copy of the GNU General Public License</span></span><br><span class="line">+<span class="comment"># along with this program; if not, write to the Free Software</span></span><br><span class="line">+<span class="comment"># Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA</span></span><br><span class="line">+<span class="comment"># 02111-1307, USA.</span></span><br><span class="line">+<span class="comment">#</span></span><br><span class="line">+<span class="comment"># Written by H Hartley Sweeten &lt;hsweeten@visionengravers.com&gt;</span></span><br><span class="line">+<span class="comment">#</span></span><br><span class="line">+</span><br><span class="line">+<span class="comment"># bits 31-28 of the Device Identification Register</span></span><br><span class="line">+0000	ep4ce22		0</span><br><span class="line">diff -Naur urjtag-orig/altera/PARTS urjtag/altera/PARTS</span><br><span class="line">--- urjtag-orig/altera/PARTS	2014-07-28 22:19:56.968449502 +1000</span><br><span class="line">+++ urjtag/altera/PARTS	2014-07-30 21:48:08.464857263 +1000</span><br><span class="line">@@ -26,3 +26,4 @@</span><br><span class="line"> 0111000100101000	epm7128aetc100		EPM7128AETC100</span><br><span class="line"> 0111000001100100	epm3064a		EPM3064A</span><br><span class="line"> 0010000010110010	ep2c8			EP2C8</span><br><span class="line">+0010000011110011	ep4ce22			EP4CE22</span><br></pre></td></tr></table></figure>
<ul>
<li>运行新版<code>UrJtag</code></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">~$ /usr/<span class="built_in">local</span>/bin/jtag</span><br><span class="line"></span><br><span class="line">UrJTAG 2021.03 <span class="comment">#</span></span><br><span class="line">Copyright (C) 2002, 2003 ETC s.r.o.</span><br><span class="line">Copyright (C) 2007, 2008, 2009 Kolja Waschk and the respective authors</span><br><span class="line"></span><br><span class="line">UrJTAG is free software, covered by the GNU General Public License, and you are</span><br><span class="line">welcome to change it and/or distribute copies of it under certain conditions.</span><br><span class="line">There is absolutely no warranty <span class="keyword">for</span> UrJTAG.</span><br><span class="line"></span><br><span class="line">warning: UrJTAG may damage your hardware!</span><br><span class="line">Type <span class="string">"quit"</span> to <span class="built_in">exit</span>, <span class="string">"help"</span> <span class="keyword">for</span> <span class="built_in">help</span>.</span><br><span class="line"></span><br><span class="line">jtag&gt; cable UsbBlaster vid=0x09fb pid=0x6001 interface=0</span><br><span class="line">Connected to libftdi driver.</span><br><span class="line">jtag&gt; detect</span><br><span class="line">IR length: 10</span><br><span class="line">Chain length: 1</span><br><span class="line">Device Id: 00000010000011110011000011011101 (0x020F30DD)</span><br><span class="line">  Manufacturer: Altera (0x0DD)</span><br><span class="line">  Part(0):      EP4CE22 (0x20F3)</span><br><span class="line">  Stepping:     0</span><br><span class="line">  Filename:     /usr/<span class="built_in">local</span>/share/urjtag/altera/ep4ce22/ep4ce22</span><br><span class="line">jtag&gt; cable usbblaster driver=ftdi</span><br><span class="line">Connected to libftdi driver.</span><br><span class="line">jtag&gt; detect</span><br><span class="line">IR length: 10</span><br><span class="line">Chain length: 1</span><br><span class="line">Device Id: 00000010000011110011000011011101 (0x020F30DD)</span><br><span class="line">  Manufacturer: Altera (0x0DD)</span><br><span class="line">  Part(0):      EP4CE22 (0x20F3)</span><br><span class="line">  Stepping:     0</span><br><span class="line">  Filename:     /usr/<span class="built_in">local</span>/share/urjtag/altera/ep4ce22/ep4ce22</span><br><span class="line">jtag&gt; <span class="built_in">print</span> chain</span><br><span class="line"> No. Manufacturer              Part                 Stepping Instruction          Register</span><br><span class="line">-------------------------------------------------------------------------------------------------------------------</span><br><span class="line">*  0 Altera                    EP4CE22              0        BYPASS               BYPASS</span><br></pre></td></tr></table></figure>
<h1 id="其它项目"><a href="#其它项目" class="headerlink" title="其它项目"></a>其它项目</h1><ul>
<li><a href="https://github.com/open-design/riscv-soc-cores" target="_blank" rel="noopener">open-design/riscv-soc-cores</a></li>
<li><a href="https://github.com/ikwzm/FPGA-SoC-Linux" target="_blank" rel="noopener">ikwzm/FPGA-SoC-Linux</a>, 下一步实践.</li>
<li><a href="http://www.nxlab.fer.hr/fpgarduino/" target="_blank" rel="noopener">fpgarduino</a>需要实践一下.</li>
<li><a href="https://www.librecores.org/olofk/serv" target="_blank" rel="noopener">olofk/serv</a> SERV - the SErial RISC-V CPU by olofk</li>
<li><a href="https://github.com/Dmitriy0111/nanoFOX" target="_blank" rel="noopener">Dmitriy0111/nanoFOX</a></li>
<li><a href="https://githubhelp.com/dosoon883/openFPGALoader" target="_blank" rel="noopener">openFPGALoader通用烧写工具</a></li>
<li><a href="https://embeddedbits.org/2020-02-20-extracting-firmware-from-devices-using-jtag/" target="_blank" rel="noopener">Extracting firmware from devices using JTAG</a></li>
</ul>
<h1 id="USB-Blaster连接问题"><a href="#USB-Blaster连接问题" class="headerlink" title="USB Blaster连接问题"></a><code>USB Blaster</code>连接问题</h1><ul>
<li><a href="https://wiki.archlinux.org/index.php/Altera_Design_Software#Error_when_scanning_hardware_-_Server_error" target="_blank" rel="noopener">Altera Design Software</a></li>
</ul>
<ul>
<li>因为这里只想使用<code>quartus_pgm</code>命令,就只下载了<code>QuartusProgrammerSetup-16.1.0.196-linux.run</code>.</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~$ jtagd --foreground --debug</span><br><span class="line"></span><br><span class="line">~$ ./jtagd --user-start --foreground</span><br><span class="line">~$ ./jtagconfig</span><br><span class="line">Error (Server error) when scanning hardware</span><br></pre></td></tr></table></figure>
<ul>
<li>测看系统日志</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">~$ dmesg</span><br><span class="line">[...]</span><br><span class="line">[25811.819181] usb 4-2: USB disconnect, device number 16</span><br><span class="line">[25814.375520] usb 4-2: new full-speed USB device number 17 using xhci_hcd</span><br><span class="line">[25814.550270] usb 4-2: New USB device found, idVendor=09fb, idProduct=6001, bcdDevice= 4.00</span><br><span class="line">[25814.550283] usb 4-2: New USB device strings: Mfr=1, Product=2, SerialNumber=3</span><br><span class="line">[25814.550289] usb 4-2: Product: USB-Blaster</span><br><span class="line">[25814.550293] usb 4-2: Manufacturer: Altera</span><br><span class="line">[25814.550297] usb 4-2: SerialNumber: 91d28408</span><br></pre></td></tr></table></figure>
<ul>
<li><p>直接运行<code>jtagconfig</code>命令,就出现下面这个错.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~$ ./jtagconfig</span><br><span class="line">Error when scanning hardware - Server error</span><br></pre></td></tr></table></figure>
</li>
<li><p>然后用<code>strace</code>运行只过滤查看<code>network</code>运行情况如下：</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">~$ strace -e trace=network jtagconfig</span><br><span class="line">[...]</span><br><span class="line">si_stime=0&#125; ---</span><br><span class="line">socket(AF_INET, SOCK_STREAM, IPPROTO_IP) = 3</span><br><span class="line">setsockopt(3, SOL_TCP, TCP_NODELAY, [1], 4) = 0</span><br><span class="line">setsockopt(3, SOL_SOCKET, SO_LINGER, &#123;l_onoff=1, l_linger=10&#125;, 8) = 0</span><br><span class="line">connect(3, &#123;sa_family=AF_INET, sin_port=htons(1309), sin_addr=inet_addr(<span class="string">"127.0.0.1"</span>)&#125;, 16) = -1 EINPROGRESS (Operation now <span class="keyword">in</span> progress)</span><br><span class="line">socket(AF_INET, SOCK_STREAM, IPPROTO_IP) = 4</span><br><span class="line">setsockopt(4, SOL_TCP, TCP_NODELAY, [1], 4) = 0</span><br><span class="line">setsockopt(4, SOL_SOCKET, SO_LINGER, &#123;l_onoff=1, l_linger=10&#125;, 8) = 0</span><br><span class="line">connect(4, &#123;sa_family=AF_INET, sin_port=htons(1309), sin_addr=inet_addr(<span class="string">"127.0.0.1"</span>)&#125;, 16) = -1 EINPROGRESS (Operation now <span class="keyword">in</span> progress)</span><br><span class="line">getsockopt(3, SOL_SOCKET, SO_ERROR, [0], [4]) = 0</span><br><span class="line">recvfrom(3, <span class="string">""</span>, 2, 0, NULL, NULL)       = 0</span><br><span class="line">getsockopt(4, SOL_SOCKET, SO_ERROR, [0], [4]) = 0</span><br><span class="line">recvfrom(4, <span class="string">""</span>, 2, 0, NULL, NULL)       = 0</span><br><span class="line">recvfrom(-1, 0x1e4ca0c, 2, 0, NULL, NULL) = -1 EBADF (Bad file descriptor)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>为排除硬件问题,又没有第二台电脑系统可试.使用<code>Virtualbox</code>安装了一个同版本的系统测试,发现在虚拟机里不做任何设置,就可以正常发现设备.如下:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~$ ./jtagconfig</span><br><span class="line">1) USB-Blaster [2-2]</span><br><span class="line">  Unable to <span class="built_in">read</span> device chain - JTAG chain broken</span><br></pre></td></tr></table></figure>
</li>
<li><p>再次按装官方文档,安装添加<code>udev</code>相关设置,再把<code>jtagd</code>开启调试模式如下：</p>
</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">~<span class="comment"># cat&gt;/etc/udev/rules.d/51-altera-usb-blaster.rules&lt;&lt;EOF</span></span><br><span class="line">SUBSYSTEM==<span class="string">"usb"</span>, ATTR&#123;idVendor&#125;==<span class="string">"09fb"</span>, ATTR&#123;idProduct&#125;==<span class="string">"6001"</span>, MODE=<span class="string">"0666"</span></span><br><span class="line">SUBSYSTEM==<span class="string">"usb"</span>, ATTR&#123;idVendor&#125;==<span class="string">"09fb"</span>, ATTR&#123;idProduct&#125;==<span class="string">"6002"</span>, MODE=<span class="string">"0666"</span></span><br><span class="line">SUBSYSTEM==<span class="string">"usb"</span>, ATTR&#123;idVendor&#125;==<span class="string">"09fb"</span>, ATTR&#123;idProduct&#125;==<span class="string">"6003"</span>, MODE=<span class="string">"0666"</span></span><br><span class="line">SUBSYSTEM==<span class="string">"usb"</span>, ATTR&#123;idVendor&#125;==<span class="string">"09fb"</span>, ATTR&#123;idProduct&#125;==<span class="string">"6010"</span>, MODE=<span class="string">"0666"</span></span><br><span class="line">SUBSYSTEM==<span class="string">"usb"</span>, ATTR&#123;idVendor&#125;==<span class="string">"09fb"</span>, ATTR&#123;idProduct&#125;==<span class="string">"6810"</span>, MODE=<span class="string">"0666"</span></span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">~$ jtagd --foreground --debug</span><br><span class="line">JTAG daemon started</span><br><span class="line">Using config file /etc/jtagd/jtagd.conf</span><br><span class="line">Remote JTAG permitted when password <span class="built_in">set</span></span><br><span class="line">USB-Blaster <span class="string">"USB-Blaster"</span> firmware version 4.00</span><br><span class="line">USB-Blaster endpoints out=02(64), <span class="keyword">in</span>=81(64); urb size=1024</span><br><span class="line">USB-Blaster added <span class="string">"USB-Blaster [4-2]"</span></span><br><span class="line">USB-Blaster port (/dev/bus/usb/004/017) opened</span><br></pre></td></tr></table></figure>
<ul>
<li>但是直接运行<code>jtagconfig</code>还是会报<code>Error when scanning hardware - Server error</code>错误.后面按照上述文档进行下面的设置就可以了.</li>
</ul>
<h2 id="jtagd服务端配置"><a href="#jtagd服务端配置" class="headerlink" title="jtagd服务端配置"></a><code>jtagd</code>服务端配置</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">~<span class="comment"># cp /fullpath/intelFPGA_lite/16.1/qprogrammer/linux64/pgm_parts.txt /etc/jtagd/jtagd.pgm_parts</span></span><br><span class="line">~<span class="comment"># echo "Password = \"123456\";" &gt; /etc/jtagd/jtagd.conf</span></span><br><span class="line">~<span class="comment"># killall -9 jtagd</span></span><br><span class="line">~$ jtagd --foreground --debug</span><br><span class="line">JTAG daemon started</span><br><span class="line">Using config file /etc/jtagd/jtagd.conf</span><br><span class="line">Remote JTAG permitted when password <span class="built_in">set</span></span><br><span class="line">USB-Blaster <span class="string">"USB-Blaster"</span> firmware version 4.00</span><br><span class="line">USB-Blaster endpoints out=02(64), <span class="keyword">in</span>=81(64); urb size=1024</span><br><span class="line">USB-Blaster added <span class="string">"USB-Blaster [6-2]"</span></span><br><span class="line">USB-Blaster port (/dev/bus/usb/006/002) opened</span><br><span class="line">USB-Blaster <span class="string">"USB-Blaster"</span> firmware version 4.00</span><br><span class="line">USB-Blaster endpoints out=02(64), <span class="keyword">in</span>=81(64); urb size=1024</span><br><span class="line">USB-Blaster reports JTAG protocol version 0, using version 0</span><br></pre></td></tr></table></figure>
<h2 id="jtagconfig配置"><a href="#jtagconfig配置" class="headerlink" title="jtagconfig配置"></a><code>jtagconfig</code>配置</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~$ jtagconfig --addserver 127.0.0.1 123456</span><br><span class="line">~$ jtagconfig</span><br><span class="line">1) USB-Blaster on 127.0.0.1 [6-2]</span><br><span class="line">  020F30DD   EP3C25/EP4CE22</span><br></pre></td></tr></table></figure>
<h1 id="谢谢支持"><a href="#谢谢支持" class="headerlink" title="谢谢支持"></a>谢谢支持</h1><ul>
<li>微信二维码:</li>
</ul>
<p><img src="/imgs/mm_reward_qrcode_1525013906055.png" width="40%" height="40%" align="center/"></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/FPGA-RISC-V-Linux/" rel="tag"># FPGA,RISC-V,Linux</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/01/13/机器学习-ML-环境的搭建/" rel="prev" title="机器学习(ML)环境的搭建">
      <i class="fa fa-chevron-left"></i> 机器学习(ML)环境的搭建
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/02/13/Kubernetes使用指南/" rel="next" title="Kubernetes使用指南">
      Kubernetes使用指南 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#开板板简介"><span class="nav-number">1.</span> <span class="nav-text">开板板简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#管脚定义"><span class="nav-number">1.1.</span> <span class="nav-text">管脚定义</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GPIO-0-Pin-Assignments"><span class="nav-number">1.1.1.</span> <span class="nav-text">GPIO-0 Pin Assignments</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GPIO-1-Pin-Assignments"><span class="nav-number">1.1.2.</span> <span class="nav-text">GPIO-1 Pin Assignments</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Table-3-8-Pin-Assignments-for-2x13-Header"><span class="nav-number">1.1.3.</span> <span class="nav-text">Table 3-8 Pin Assignments for 2x13 Header</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Table-3-9-Pin-Assignments-for-ADC"><span class="nav-number">1.1.4.</span> <span class="nav-text">Table 3-9 Pin Assignments for ADC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JTAG"><span class="nav-number">1.1.5.</span> <span class="nav-text">JTAG</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OpenRisc"><span class="nav-number">2.</span> <span class="nav-text">OpenRisc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GCC工具链"><span class="nav-number">2.1.</span> <span class="nav-text">GCC工具链</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#编译ORPSOC"><span class="nav-number">2.2.</span> <span class="nav-text">编译ORPSOC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#编译Linux"><span class="nav-number">2.3.</span> <span class="nav-text">编译Linux</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#烧写入bitstream"><span class="nav-number">2.4.</span> <span class="nav-text">烧写入bitstream</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#连接串号"><span class="nav-number">2.5.</span> <span class="nav-text">连接串号</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#FuseSOC-试用"><span class="nav-number">3.</span> <span class="nav-text">FuseSOC 试用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装fuseSoc"><span class="nav-number">3.1.</span> <span class="nav-text">安装fuseSoc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装fusesoc-库"><span class="nav-number">3.2.</span> <span class="nav-text">安装fusesoc 库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Fusesoc-demos"><span class="nav-number">3.3.</span> <span class="nav-text">Fusesoc-demos</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RISC-V"><span class="nav-number">4.</span> <span class="nav-text">RISC-V</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装Quartus20"><span class="nav-number">4.1.</span> <span class="nav-text">安装Quartus20</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#litex-boards测试编译"><span class="nav-number">4.2.</span> <span class="nav-text">litex-boards测试编译</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#linux-on-litex-vexriscv编译测试"><span class="nav-number">4.3.</span> <span class="nav-text">linux-on-litex-vexriscv编译测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#通过JTAG-UART查看启动信息"><span class="nav-number">4.3.1.</span> <span class="nav-text">通过JTAG-UART查看启动信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过串口查看系统启动信息"><span class="nav-number">4.3.2.</span> <span class="nav-text">通过串口查看系统启动信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加SPI-SDCard外设"><span class="nav-number">4.3.3.</span> <span class="nav-text">添加SPI-SDCard外设</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#quartus-cpf命令"><span class="nav-number">4.3.4.</span> <span class="nav-text">quartus_cpf命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#用openocd加载svf文件"><span class="nav-number">4.4.</span> <span class="nav-text">用openocd加载svf文件.</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#烧写到SPI-FLASH"><span class="nav-number">4.5.</span> <span class="nav-text">烧写到SPI FLASH</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UrJtag使用"><span class="nav-number">4.6.</span> <span class="nav-text">UrJtag使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#其它项目"><span class="nav-number">5.</span> <span class="nav-text">其它项目</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#USB-Blaster连接问题"><span class="nav-number">6.</span> <span class="nav-text">USB Blaster连接问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#jtagd服务端配置"><span class="nav-number">6.1.</span> <span class="nav-text">jtagd服务端配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jtagconfig配置"><span class="nav-number">6.2.</span> <span class="nav-text">jtagconfig配置</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#谢谢支持"><span class="nav-number">7.</span> <span class="nav-text">谢谢支持</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="yjdwbj"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">yjdwbj</p>
  <div class="site-description" itemprop="description">最是人间留不住,朱颜辞镜花辞树</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">52</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">44</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yjdwbj</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  

</body>
</html>
